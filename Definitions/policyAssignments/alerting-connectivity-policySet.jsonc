{
  "$schema": "https://raw.githubusercontent.com/Azure/enterprise-azure-policy-as-code/main/Schemas/policy-assignment-schema.json",
  "nodeName": "/root",
  "definitionEntry": {
    "policySetName": "Alerting-Connectivity",
    "displayName": "Deploy Azure Monitor Baseline Alerts for Connectivity",
    "nonComplianceMessages": [
      {
        "policyDefinitionReferenceId": null,
        "message": "Alerting must be deployed to Azure services."
      }
    ]
  },
  "assignment": {
    "name": "Deploy-AMBA-Connectivity",
    "displayName": "Deploy Azure Monitor Baseline Alerts for Connectivity",
    "description": "Initiative to deploy AMBA alerts relevant to the ALZ Connectivity management group"
  },
  "metadata": {
    "_deployed_by_amba": true
  },
  "parameters": {
    "erpRxLightLevelHighAlertState": "true",
    "ercirArpAvailabilityPolicyEffect": "deployIfNotExists",
    "erpBitsInPerSecondPolicyEffect": "deployIfNotExists",
    "vnetddosAttackAlertSeverity": "1",
    "erpRxLightLevelLowAlertSeverity": "1",
    "afwsnatPortUtilizationThreshold": "80",
    "firewallHealthThreshold": "90",
    "vnetGwERCpuUtilPolicyEffect": "deployIfNotExists",
    "erGwExpressRouteBitsInPolicyEffect": "disabled",
    "erpRxLightLevelLowEvaluationFrequency": "PT1M",
    "vpngwEgressThreshold": "1",
    "vpngwTunnelIngressPacketDropMismatchAlertState": "true",
    "pipBytesInDDoSWindowSize": "PT5M",
    "firewallHealthPolicyEffect": "deployIfNotExists",
    "erpBitsInPerSecondEvaluationFrequency": "PT1M",
    "vpngwTunnelEgressPacketDropCountAlertState": "true",
    "vnetGwTunnelIngressPolicyEffect": "disabled",
    "vnetGwTunnelIngressWindowSize": "PT5M",
    "vnetGwTunnelBWPolicyEffect": "deployIfNotExists",
    "vpngwEgressEvaluationFrequency": "PT5M",
    "pdnszRegistrationCapacityUtilWindowSize": "PT1H",
    "vnetGwTunnelBWAlertState": "true",
    "vnetGwTunnelIngressPacketDropMismatchAlertSeverity": "3",
    "vnetGwTunnelEgressPacketDropCountAlertSeverity": "1",
    "vpngwIngressAutoMitigate": "true",
    "vpngwTunnelIngressPacketDropCountAlertState": "true",
    "vnetGwTunnelBWAlertSeverity": "0",
    "vpngwEgressWindowSize": "PT5M",
    "vnetGwTunnelEgressPacketDropMismatchEvaluationFrequency": "PT5M",
    "alzMonitorResourceGroupName": "rg-amba-monitor",
    "vpngwIngressEvaluationFrequency": "PT5M",
    "erGwExpressRouteBitsOutThreshold": "1",
    "vnetGwTunnelIngressAlertSeverity": "0",
    "vpngwEgressPolicyEffect": "disabled",
    "vnetGwTunnelIngressPacketDropCountPolicyEffect": "deployIfNotExists",
    "vnetGwTunnelIngressThreshold": "1",
    "erpTxLightLevelHighAlertState": "true",
    "vnetGwTunnelIngressPacketDropMismatchEvaluationFrequency": "PT5M",
    "vnetGwTunnelIngressPacketDropMismatchWindowSize": "PT5M",
    "erGwExpressRouteBitsInThreshold": "1",
    "ercirBgpAvailabilityPolicyEffect": "deployIfNotExists",
    "vpngwTunnelEgressPacketDropCountWindowSize": "PT5M",
    "vnetddosAttackAlertState": "true",
    "vpngwTunnelIngressPacketDropCountAlertSeverity": "3",
    "firewallHealthAlertSeverity": "0",
    "vpngwTunnelIngressPacketDropMismatchPolicyEffect": "deployIfNotExists",
    "vnetGwERCpuUtilAlertSeverity": "3",
    "ercirQoSDropBitsinPerSecAlertState": "true",
    "vnetGwTunnelEgressPacketDropCountAlertState": "true",
    "vnetddosAttackEvaluationFrequency": "PT1M",
    "erGwExpressRouteCpuUtilEvaluationFrequency": "PT1M",
    "vpngwTunnelEgressPacketDropCountPolicyEffect": "deployIfNotExists",
    "pdnszCapacityUtilWindowSize": "PT1H",
    "pipPacketsInDDoSThreshold": "40000",
    "pipvipAvailabilityEvaluationFrequency": "PT1M",
    "erpTxLightLevelHighEvaluationFrequency": "PT1M",
    "vpngwIngressAlertState": "true",
    "pdnszRecordSetCapacityAlertState": "true",
    "pipBytesInDDoSAlertSeverity": "4",
    "lbUsedSNATPortsWindowSize": "PT5M",
    "erpRxLightLevelHighAlertSeverity": "1",
    "vpnGwBGPPeerStatusAlertState": "true",
    "ercirQoSDropBitsinPerSecPolicyEffect": "deployIfNotExists",
    "vnetGwTunnelEgressPacketDropMismatchPolicyEffect": "deployIfNotExists",
    "vpngwTunnelEgressPacketDropMismatchFrequency": "PT5M",
    "vnetGwTunnelIngressPacketDropCountAlertSeverity": "3",
    "lbHealthProbeStatusWindowSize": "PT5M",
    "vnetGwExpressRouteBitsPerSecondAlertSeverity": "0",
    "lbDatapathAvailabilityAlertSeverity": "0",
    "vnetGwTunnelEgressThreshold": "1",
    "erpBitsInPerSecondWindowSize": "PT5M",
    "activityUDRUpdateAlertState": "true",
    "pdnszQueryVolumePolicyEffect": "disabled",
    "lbHealthProbeStatusPolicyEffect": "deployIfNotExists",
    "erGwExpressRouteCpuUtilAlertState": "true",
    "vpngwTunnelIngressPacketDropCountWindowSize": "PT5M",
    "ercirArpAvailabilityAlertState": "true",
    "erpBitsOutPerSecondEvaluationFrequency": "PT1M",
    "erGwExpressRouteBitsOutAlertSeverity": "0",
    "pdnszRegistrationCapacityUtilPolicyEffect": "deployIfNotExists",
    "vpngwTunnelEgressPacketDropCountAlertSeverity": "3",
    "ercirBgpAvailabilityAlertSeverity": "0",
    "ercirArpAvailabilityWindowSize": "PT5M",
    "pipdDoSAttackPolicyEffect": "deployIfNotExists",
    "afwsnatPortUtilizationPolicyEffect": "deployIfNotExists",
    "erpLineProtocolWindowSize": "PT5M",
    "erpLineProtocolEvaluationFrequency": "PT1M",
    "pdnszRecordSetCapacityWindowSize": "PT1H",
    "erpRxLightLevelLowPolicyEffect": "deployIfNotExists",
    "vnetGwTunnelEgressPacketDropMismatchAlertState": "true",
    "vpnGwBGPPeerStatusAlertSeverity": "3",
    "erGwExpressRouteBitsInAlertSeverity": "0",
    "ercirQoSDropBitsoutPerSecEvaluationFrequency": "PT5M",
    "ercirBgpAvailabilityAlertState": "true",
    "activityNSGDeleteAlertState": "true",
    "pdnszRegistrationCapacityUtilThreshold": "80",
    "vnetGwTunnelIngressPacketDropCountAlertState": "true",
    "erpBitsInPerSecondAlertSeverity": "0",
    "vnetGwExpressRouteBitsPerSecondThreshold": "1",
    "vpngwIngressPolicyEffect": "disabled",
    "pipdDoSAttackAlertSeverity": "1",
    "erGwExpressRouteBitsOutEvaluationFrequency": "PT5M",
    "vpngwTunnelEgressPacketDropCountFrequency": "PT5M",
    "lbDatapathAvailabilityPolicyEffect": "deployIfNotExists",
    "pipBytesInDDoSThreshold": "8000000",
    "vnetGwTunnelEgressEvaluationFrequency": "PT5M",
    "erpBitsInPerSecondAlertState": "true",
    "ercirQoSDropBitsoutPerSecAlertState": "true",
    "ercirQoSDropBitsinPerSecAlertSeverity": "2",
    "vnetGwTunnelBWWindowSize": "PT5M",
    "afwsnatPortUtilizationFrequency": "PT1M",
    "firewallHealthWindowSize": "PT5M",
    "activityFWDeleteAlertState": "true",
    "pdnszQueryVolumeAlertState": "true",
    "firewallHealthAlertState": "true",
    "vpnGwBGPPeerStatusPolicyEffect": "deployIfNotExists",
    "vpngwBandWidthUtilAlertSeverity": "0",
    "afwsnatPortUtilizationAlertSeverity": "1",
    "erpRxLightLevelHighWindowSize": "PT5M",
    "vnetGwTunnelIngressPacketDropMismatchAlertState": "true",
    "vnetGwTunnelIngressPacketDropCountWindowSize": "PT5M",
    "vpngwBandWidthUtilAlertState": "true",
    "pipvipAvailabilityAlertSeverity": "1",
    "erpTxLightLevelHighPolicyEffect": "deployIfNotExists",
    "vnetGwExpressRouteBitsPerSecondPolicyEffect": "deployIfNotExists",
    "vnetGwTunnelEgressAlertSeverity": "0",
    "pdnszRegistrationCapacityUtilEvaluationFrequency": "PT1H",
    "activityVPNGWDeleteAlertState": "true",
    "pdnszQueryVolumeAlertSeverity": "4",
    "lbHealthProbeStatusEvaluationFrequency": "PT1M",
    "vpngwTunnelIngressPacketDropMismatchAlertSeverity": "3",
    "erGwExpressRouteCpuUtilPolicyEffect": "deployIfNotExists",
    "vnetGwTunnelEgressPacketDropMismatchAlertSeverity": "3",
    "vnetGwTunnelEgressPacketDropCountPolicyEffect": "deployIfNotExists",
    "pipdDoSAttackAlertState": "true",
    "vpngwBandWidthUtilThreshold": "1",
    "ercirArpAvailabilityAlertSeverity": "0",
    "pdnszRecordSetCapacityEvaluationFrequency": "PT1H",
    "erGwExpressRouteBitsOutAlertState": "true",
    "pipdDoSAttackEvaluationFrequency": "PT5M",
    "firewallHealthEvaluationFrequency": "PT1M",
    "vnetGwTunnelEgressPacketDropMismatchWindowSize": "PT5M",
    "lbGlobalBackendAvailabilityAlertSeverity": "0",
    "lbUsedSNATPortsEvaluationFrequency": "PT1M",
    "lbUsedSNATPortsAlertState": "true",
    "erGwExpressRouteCpuUtilThreshold": "80",
    "pipPacketsInDDoSAlertState": "true",
    "erpTxLightLevelHighAlertSeverity": "1",
    "erpRxLightLevelLowAlertState": "true",
    "ercirBgpAvailabilityThreshold": "90",
    "pdnszRecordSetCapacityPolicyEffect": "deployIfNotExists",
    "pdnszCapacityUtilPolicyEffect": "deployIfNotExists",
    "afwsnatPortUtilizationAlertState": "true",
    "pipvipAvailabilityWindowSize": "PT5M",
    "erpTxLightLevelLowEvaluationFrequency": "PT1M",
    "vnetGwExpressRouteBitsPerSecondAlertState": "true",
    "vnetGwERCpuUtilWindowSize": "PT5M",
    "erpLineProtocolAlertState": "true",
    "ercirQoSDropBitsinPerSecWindowSize": "PT5M",
    "erpLineProtocolAlertSeverity": "0",
    "erpRxLightLevelHighEvaluationFrequency": "PT1M",
    "erpTxLightLevelLowAlertSeverity": "1",
    "vpngwIngressAlertSeverity": "0",
    "pipPacketsInDDoSEvaluationFrequency": "PT5M",
    "vpngwTunnelEgressPacketDropMismatchPolicyEffect": "deployIfNotExists",
    "vpngwIngressWindowSize": "PT5M",
    "lbHealthProbeStatusAlertSeverity": "2",
    "pipPacketsInDDoSPolicyEffect": "disabled",
    "alzMonitorResourceGroupLocation": "eastus",
    "erpTxLightLevelLowAlertState": "true",
    "vnetGwTunnelBWEvaluationFrequency": "PT1M",
    "vnetGwTunnelIngressPacketDropCountEvaluationFrequency": "PT5M",
    "ercirBgpAvailabilityWindowSize": "PT5M",
    "pipdDoSAttackWindowSize": "PT5M",
    "pdnszCapacityUtilAlertState": "true",
    "alzMonitorResourceGroupTags": {
      "Project": "alz-monitor"
    },
    "pipBytesInDDoSAlertState": "true",
    "lbDatapathAvailabilityAlertState": "true",
    "lbDatapathAvailabilityWindowSize": "PT5M",
    "vnetGwTunnelEgressAlertState": "true",
    "vnetddosAttackPolicyEffect": "deployIfNotExists",
    "lbUsedSNATPortsPolicyEffect": "deployIfNotExists",
    "lbGlobalBackendAvailabilityAlertState": "true",
    "vpnGwBGPPeerStatusWindowSize": "PT5M",
    "erpTxLightLevelLowWindowSize": "PT5M",
    "vnetddosAttackWindowSize": "PT5M",
    "ercirQoSDropBitsoutPerSecWindowSize": "PT5M",
    "pipvipAvailabilityThreshold": "1",
    "vnetGwERCpuUtilEvaluationFrequency": "PT1M",
    "pipBytesInDDoSEvaluationFrequency": "PT5M",
    "vpnGwBGPPeerStatusThreshold": "1",
    "ercirQoSDropBitsoutPerSecPolicyEffect": "deployIfNotExists",
    "pipvipAvailabilityAlertState": "true",
    "vnetGwExpressRouteBitsPerSecondEvaluationFrequency": "PT1M",
    "lbGlobalBackendAvailabilityPolicyEffect": "deployIfNotExists",
    "afwsnatPortUtilizationWindowSize": "PT5M",
    "pdnszRecordSetCapacityAlertSeverity": "2",
    "erGwExpressRouteBitsInWindowSize": "PT5M",
    "erGwExpressRouteBitsInAlertState": "true",
    "lbGlobalBackendAvailabilityEvaluationFrequency": "PT1M",
    "erpRxLightLevelHighPolicyEffect": "deployIfNotExists",
    "vpngwTunnelIngressPacketDropMismatchWindowSize": "PT5M",
    "vnetGwExpressRouteBitsPerSecondWindowSize": "PT5M",
    "ercirQoSDropBitsinPerSecEvaluationFrequency": "PT5M",
    "pdnszQueryVolumeThreshold": "500",
    "vnetGwTunnelEgressPacketDropCountWindowSize": "PT5M",
    "pipBytesInDDoSPolicyEffect": "disabled",
    "erpBitsOutPerSecondAlertSeverity": "0",
    "lbGlobalBackendAvailabilityWindowSize": "PT5M",
    "vnetGwERCpuUtilAlertState": "true",
    "erpBitsOutPerSecondPolicyEffect": "deployIfNotExists",
    "vpngwTunnelIngressPacketDropCountFrequency": "PT5M",
    "vnetGwTunnelEgressPolicyEffect": "disabled",
    "ercirArpAvailabilityFrequency": "PT1M",
    "erpRxLightLevelLowWindowSize": "PT5M",
    "vnetGwTunnelEgressPacketDropCountEvaluationFrequency": "PT5M",
    "vpngwBandWidthUtilPolicyEffect": "deployIfNotExists",
    "vpngwIngressThreshold": "1",
    "vpngwTunnelEgressPacketDropMismatchAlertState": "true",
    "erpBitsOutPerSecondWindowSize": "PT5M",
    "vnetddosAttackThreshold": "1",
    "pipdDoSAttackThreshold": "0",
    "pdnszCapacityUtilThreshold": "80",
    "pdnszCapacityUtilAlertSeverity": "2",
    "erGwExpressRouteCpuUtilWindowSize": "PT5M",
    "lbDatapathAvailabilityEvaluationFrequency": "PT1M",
    "erpLineProtocolPolicyEffect": "deployIfNotExists",
    "erGwExpressRouteBitsInEvaluationFrequency": "PT5M",
    "pipvipAvailabilityPolicyEffect": "deployIfNotExists",
    "pdnszQueryVolumeWindowSize": "PT1H",
    "erpTxLightLevelLowPolicyEffect": "deployIfNotExists",
    "vnetGwTunnelIngressAlertState": "true",
    "pipPacketsInDDoSWindowSize": "PT5M",
    "vpngwEgressAlertSeverity": "0",
    "lbHealthProbeStatusAlertState": "true",
    "ercirQoSDropBitsoutPerSecAlertSeverity": "2",
    "lbUsedSNATPortsAlertSeverity": "1",
    "erpBitsOutPerSecondAlertState": "true",
    "vpngwBandWidthUtilEvaluationFrequency": "PT5M",
    "pdnszRegistrationCapacityUtilAlertSeverity": "2",
    "erpTxLightLevelHighWindowSize": "PT5M",
    "pdnszQueryVolumeEvaluationFrequency": "PT1H",
    "vpngwBandWidthUtilWindowSize": "PT5M",
    "vnetGwTunnelIngressEvaluationFrequency": "PT5M",
    "vnetGwTunnelIngressPacketDropMismatchPolicyEffect": "deployIfNotExists",
    "vpnGwBGPPeerStatusEvaluationFrequency": "PT5M",
    "vpngwTunnelEgressPacketDropMismatchWindowSize": "PT5M",
    "pdnszRecordSetCapacityThreshold": "80",
    "erGwExpressRouteBitsOutPolicyEffect": "disabled",
    "pdnszRegistrationCapacityUtilAlertState": "true",
    "ercirBgpAvailabilityEvaluationFrequency": "PT1M",
    "vpngwEgressAlertState": "true",
    "vpngwTunnelIngressPacketDropCountPolicyEffect": "deployIfNotExists",
    "erGwExpressRouteBitsOutWindowSize": "PT5M",
    "pipPacketsInDDoSAlertSeverity": "4",
    "pdnszCapacityUtilEvaluationFrequency": "PT1H",
    "vnetGwTunnelBWThreshold": "1",
    "ercirArpAvailabilityThreshold": "90",
    "erGwExpressRouteCpuUtilAlertSeverity": "1",
    "vnetGwTunnelEgressWindowSize": "PT5M",
    "vnetGwERCpuUtilThreshold": "80",
    "vpngwTunnelEgressPacketDropMismatchAlertSeverity": "3",
    "vpngwTunnelIngressPacketDropMismatchFrequency": "PT5M"
  },
  "scope": {
    "amba": [
      "/providers/Microsoft.Management/managementGroups/amba-connectivity"
    ]
  }
}