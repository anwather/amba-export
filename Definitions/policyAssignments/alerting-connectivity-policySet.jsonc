{
  "$schema": "https://raw.githubusercontent.com/Azure/enterprise-azure-policy-as-code/main/Schemas/policy-assignment-schema.json",
  "nodeName": "/root",
  "definitionEntry": {
    "policySetName": "Alerting-Connectivity",
    "displayName": "Deploy Azure Monitor Baseline Alerts for Connectivity",
    "nonComplianceMessages": [
      {
        "policyDefinitionReferenceId": null,
        "message": "Alerting must be deployed to Azure services."
      }
    ]
  },
  "assignment": {
    "name": "Deploy-AMBA-Connectivity",
    "displayName": "Deploy Azure Monitor Baseline Alerts for Connectivity",
    "description": "This initiative deploys Azure Monitor Baseline Alerts to monitor Network components such as Azure Firewalls, ExpressRoute, VPN, and Private DNS Zones."
  },
  "metadata": {
    "_deployed_by_amba": true
  },
  "parameters": {
    "AFWSNATPortUtilizationWindowSize": "PT5M",
    "PDNSZCapacityUtilAlertState": "true",
    "VPNGWBandWidthUtilThreshold": "1",
    "ERPTxLightLevelLowWindowSize": "PT5M",
    "AFWSNATPortUtilizationFrequency": "PT1M",
    "VnetGwExpressRouteBitsPerSecondPolicyEffect": "deployIfNotExists",
    "VPNGWEgressAlertState": "true",
    "ERGwExpressRouteCpuUtilAlertSeverity": "1",
    "ERPBitsInPerSecondWindowSize": "PT5M",
    "ERCIRBgpAvailabilityAlertState": "true",
    "ERGwExpressRouteBitsOutAlertSeverity": "0",
    "PDNSZQueryVolumeAlertState": "true",
    "VnetGwTunnelIngressPacketDropMismatchAlertState": "true",
    "ERGwExpressRouteBitsInEvaluationFrequency": "PT5M",
    "VPNGWBandWidthUtilAlertState": "true",
    "VnetGwTunnelEgressWindowSize": "PT5M",
    "VnetGwTunnelEgressAlertSeverity": "0",
    "VnetGwTunnelIngressPacketDropCountAlertSeverity": "3",
    "ERCIRQoSDropBitsoutPerSecAlertState": "true",
    "ERGwExpressRouteBitsOutThreshold": "1",
    "VnetGwERCpuUtilThreshold": "80",
    "PDNSZQueryVolumeEvaluationFrequency": "PT1H",
    "ERGwExpressRouteCpuUtilWindowSize": "PT5M",
    "PIPVIPAvailabilityThreshold": "1",
    "ERPBitsInPerSecondAlertState": "true",
    "VPNGWTunnelIngressPacketDropCountWindowSize": "PT5M",
    "ERCIRBgpAvailabilityThreshold": "90",
    "PDNSZRecordSetCapacityEvaluationFrequency": "PT1H",
    "VPNGWTunnelEgressPacketDropMismatchAlertSeverity": "3",
    "ALZMonitorDisableTagName": "MonitorDisable",
    "PIPBytesInDDoSThreshold": "8000000",
    "ERPRxLightLevelLowAlertState": "true",
    "PDNSZRecordSetCapacityThreshold": "80",
    "PIPVIPAvailabilityEvaluationFrequency": "PT1M",
    "ERGwExpressRouteCpuUtilPolicyEffect": "deployIfNotExists",
    "PIPVIPAvailabilityAlertSeverity": "1",
    "LBDatapathAvailabilityWindowSize": "PT5M",
    "ERCIRArpAvailabilityAlertState": "true",
    "VnetGwExpressRouteBitsPerSecondWindowSize": "PT5M",
    "ERCIRBgpAvailabilityAlertSeverity": "0",
    "PIPDDoSAttackAlertSeverity": "1",
    "ERPLineProtocolAlertState": "true",
    "LBDatapathAvailabilityAlertState": "true",
    "LBHealthProbeStatusEvaluationFrequency": "PT1M",
    "ERCIRBgpAvailabilityEvaluationFrequency": "PT1M",
    "VPNGWTunnelIngressPacketDropMismatchPolicyEffect": "deployIfNotExists",
    "VnetGwTunnelIngressPacketDropMismatchWindowSize": "PT5M",
    "ERCIRBgpAvailabilityPolicyEffect": "deployIfNotExists",
    "PDNSZCapacityUtilWindowSize": "PT1H",
    "ERCIRQoSDropBitsinPerSecPolicyEffect": "deployIfNotExists",
    "PIPPacketsInDDoSWindowSize": "PT5M",
    "VPNGWIngressThreshold": "1",
    "VPNGWEgressAlertSeverity": "0",
    "ERGwExpressRouteBitsOutPolicyEffect": "disabled",
    "VnetGwERCpuUtilAlertSeverity": "3",
    "ALZMonitorResourceGroupName": "rg-amba-monitoring-001",
    "VnetGwTunnelEgressPacketDropCountPolicyEffect": "deployIfNotExists",
    "VnetGwERCpuUtilEvaluationFrequency": "PT1M",
    "VPNGwBGPPeerStatusPolicyEffect": "deployIfNotExists",
    "activityFWDeleteAlertState": "true",
    "VPNGWTunnelEgressPacketDropCountAlertState": "true",
    "VnetGwTunnelEgressPacketDropCountAlertState": "true",
    "VnetGwTunnelIngressWindowSize": "PT5M",
    "PIPVIPAvailabilityAlertState": "true",
    "ERPBitsOutPerSecondAlertState": "true",
    "ERPTxLightLevelHighEvaluationFrequency": "PT1M",
    "PIPBytesInDDoSPolicyEffect": "disabled",
    "ERPTxLightLevelHighAlertSeverity": "1",
    "VPNGwBGPPeerStatusThreshold": "1",
    "ERCIRQoSDropBitsoutPerSecAlertSeverity": "2",
    "AFWSNATPortUtilizationAlertSeverity": "1",
    "ERPTxLightLevelHighAlertState": "true",
    "VnetGwTunnelIngressEvaluationFrequency": "PT5M",
    "VPNGWIngressEvaluationFrequency": "PT5M",
    "PIPPacketsInDDoSPolicyEffect": "disabled",
    "ALZMonitorResourceGroupTags": {
      "Project": "amba-monitoring"
    },
    "VnetGwExpressRouteBitsPerSecondThreshold": "1",
    "VPNGWBandWidthUtilPolicyEffect": "deployIfNotExists",
    "VPNGWTunnelEgressPacketDropMismatchAlertState": "true",
    "ERPBitsInPerSecondAlertSeverity": "0",
    "PIPBytesInDDoSWindowSize": "PT5M",
    "ERGwExpressRouteBitsOutEvaluationFrequency": "PT5M",
    "VPNGWBandWidthUtilAlertSeverity": "0",
    "PDNSZCapacityUtilEvaluationFrequency": "PT1H",
    "ERPRxLightLevelLowWindowSize": "PT5M",
    "VPNGWTunnelEgressPacketDropMismatchWindowSize": "PT5M",
    "activityUDRUpdatePolicyEffect": "deployIfNotExists",
    "FirewallHealthThreshold": "90",
    "VNETDDOSAttackAlertSeverity": "1",
    "VPNGWIngressWindowSize": "PT5M",
    "PDNSZRegistrationCapacityUtilAlertSeverity": "2",
    "ERPBitsOutPerSecondWindowSize": "PT5M",
    "VPNGWTunnelEgressPacketDropCountFrequency": "PT5M",
    "ERPTxLightLevelHighPolicyEffect": "deployIfNotExists",
    "activityFWDeletePolicyEffect": "deployIfNotExists",
    "VPNGWTunnelIngressPacketDropMismatchFrequency": "PT5M",
    "ERCIRArpAvailabilityPolicyEffect": "deployIfNotExists",
    "ERPLineProtocolAlertSeverity": "0",
    "PIPDDoSAttackAlertState": "true",
    "LBGlobalBackendAvailabilityAlertSeverity": "0",
    "VPNGWTunnelIngressPacketDropMismatchAlertState": "true",
    "VnetGwERCpuUtilPolicyEffect": "deployIfNotExists",
    "VnetGwERCpuUtilAlertState": "true",
    "FirewallHealthAlertSeverity": "0",
    "VPNGWTunnelIngressPacketDropMismatchWindowSize": "PT5M",
    "VPNGWIngressAlertSeverity": "0",
    "PDNSZQueryVolumeWindowSize": "PT1H",
    "VnetGwTunnelIngressPacketDropCountWindowSize": "PT5M",
    "LBUsedSNATPortsAlertSeverity": "1",
    "VnetGwTunnelEgressPacketDropMismatchAlertState": "true",
    "PDNSZRegistrationCapacityUtilWindowSize": "PT1H",
    "PDNSZQueryVolumePolicyEffect": "disabled",
    "PDNSZRecordSetCapacityWindowSize": "PT1H",
    "VnetGwERCpuUtilWindowSize": "PT5M",
    "PIPDDoSAttackEvaluationFrequency": "PT5M",
    "LBUsedSNATPortsWindowSize": "PT5M",
    "VnetGwTunnelIngressAlertState": "true",
    "VnetGwTunnelIngressAlertSeverity": "0",
    "PIPDDoSAttackPolicyEffect": "deployIfNotExists",
    "LBUsedSNATPortsEvaluationFrequency": "PT1M",
    "ERPBitsInPerSecondEvaluationFrequency": "PT1M",
    "VnetGwExpressRouteBitsPerSecondAlertSeverity": "0",
    "ERCIRQoSDropBitsinPerSecWindowSize": "PT5M",
    "activityVPNGWDeleteAlertState": "true",
    "AFWSNATPortUtilizationThreshold": "80",
    "PDNSZCapacityUtilThreshold": "80",
    "PDNSZQueryVolumeAlertSeverity": "4",
    "LBDatapathAvailabilityEvaluationFrequency": "PT1M",
    "ERPTxLightLevelLowEvaluationFrequency": "PT1M",
    "LBUsedSNATPortsPolicyEffect": "deployIfNotExists",
    "PIPPacketsInDDoSAlertState": "true",
    "VnetGwTunnelEgressPacketDropCountAlertSeverity": "1",
    "VPNGWEgressPolicyEffect": "disabled",
    "ERPBitsOutPerSecondAlertSeverity": "0",
    "ERCIRArpAvailabilityWindowSize": "PT5M",
    "VnetGwTunnelEgressPacketDropCountEvaluationFrequency": "PT5M",
    "VPNGWBandWidthUtilWindowSize": "PT5M",
    "VnetGwTunnelEgressPacketDropMismatchEvaluationFrequency": "PT5M",
    "activityVPNGWDeletePolicyEffect": "deployIfNotExists",
    "PIPDDoSAttackThreshold": "0",
    "VNETDDOSAttackPolicyEffect": "deployIfNotExists",
    "PIPVIPAvailabilityPolicyEffect": "deployIfNotExists",
    "ERCIRArpAvailabilityFrequency": "PT1M",
    "PIPBytesInDDoSAlertState": "true",
    "ERCIRQoSDropBitsinPerSecAlertSeverity": "2",
    "FirewallHealthPolicyEffect": "deployIfNotExists",
    "LBGlobalBackendAvailabilityAlertState": "true",
    "VnetGwTunnelBWAlertSeverity": "0",
    "VnetGwTunnelBWAlertState": "true",
    "ERPRxLightLevelHighAlertSeverity": "1",
    "LBGlobalBackendAvailabilityPolicyEffect": "deployIfNotExists",
    "VPNGWIngressAutoMitigate": "true",
    "LBHealthProbeStatusAlertState": "true",
    "ERPRxLightLevelLowPolicyEffect": "deployIfNotExists",
    "LBHealthProbeStatusPolicyEffect": "deployIfNotExists",
    "VPNGWEgressThreshold": "1",
    "LBUsedSNATPortsAlertState": "true",
    "VPNGwBGPPeerStatusAlertSeverity": "3",
    "VnetGwTunnelBWWindowSize": "PT5M",
    "VnetGwTunnelIngressPolicyEffect": "disabled",
    "VNETDDOSAttackWindowSize": "PT5M",
    "ERCIRArpAvailabilityAlertSeverity": "0",
    "ERPBitsOutPerSecondEvaluationFrequency": "PT1M",
    "LBHealthProbeStatusAlertSeverity": "2",
    "ERPTxLightLevelLowAlertState": "true",
    "ERGwExpressRouteCpuUtilEvaluationFrequency": "PT1M",
    "VPNGWEgressEvaluationFrequency": "PT5M",
    "PDNSZRecordSetCapacityAlertState": "true",
    "VPNGwBGPPeerStatusEvaluationFrequency": "PT5M",
    "VnetGwTunnelIngressThreshold": "1",
    "VPNGWTunnelEgressPacketDropCountAlertSeverity": "3",
    "ALZMonitorDisableTagValues": [
      "true",
      "Test",
      "Dev",
      "Sandbox"
    ],
    "VnetGwTunnelIngressPacketDropMismatchAlertSeverity": "3",
    "VnetGwTunnelEgressThreshold": "1",
    "AFWSNATPortUtilizationPolicyEffect": "deployIfNotExists",
    "PDNSZQueryVolumeThreshold": "500",
    "ERGwExpressRouteBitsInAlertSeverity": "0",
    "PIPPacketsInDDoSThreshold": "40000",
    "VNETDDOSAttackEvaluationFrequency": "PT1M",
    "PDNSZRegistrationCapacityUtilAlertState": "true",
    "ERPLineProtocolPolicyEffect": "deployIfNotExists",
    "ERGwExpressRouteBitsInThreshold": "1",
    "PIPPacketsInDDoSAlertSeverity": "4",
    "VNETDDOSAttackThreshold": "1",
    "ALZMonitorResourceGroupLocation": "eastus",
    "ERPRxLightLevelLowAlertSeverity": "1",
    "ERCIRBgpAvailabilityWindowSize": "PT5M",
    "LBDatapathAvailabilityPolicyEffect": "deployIfNotExists",
    "VPNGwBGPPeerStatusWindowSize": "PT5M",
    "ERGwExpressRouteBitsInPolicyEffect": "disabled",
    "VnetGwTunnelBWPolicyEffect": "deployIfNotExists",
    "ERCIRQoSDropBitsoutPerSecWindowSize": "PT5M",
    "ERPRxLightLevelHighWindowSize": "PT5M",
    "ERPRxLightLevelHighAlertState": "true",
    "ERGwExpressRouteCpuUtilThreshold": "80",
    "activityUDRUpdateAlertState": "true",
    "ERCIRArpAvailabilityThreshold": "90",
    "VPNGWIngressAlertState": "true",
    "VPNGWTunnelEgressPacketDropCountWindowSize": "PT5M",
    "ERPBitsInPerSecondPolicyEffect": "deployIfNotExists",
    "ERPTxLightLevelLowPolicyEffect": "deployIfNotExists",
    "PIPVIPAvailabilityWindowSize": "PT5M",
    "ERPRxLightLevelLowEvaluationFrequency": "PT1M",
    "VPNGWBandWidthUtilEvaluationFrequency": "PT5M",
    "VPNGWTunnelIngressPacketDropMismatchAlertSeverity": "3",
    "VPNGWTunnelEgressPacketDropMismatchFrequency": "PT5M",
    "VnetGwExpressRouteBitsPerSecondAlertState": "true",
    "ERPLineProtocolWindowSize": "PT5M",
    "VPNGWTunnelEgressPacketDropMismatchPolicyEffect": "deployIfNotExists",
    "PDNSZRegistrationCapacityUtilEvaluationFrequency": "PT1H",
    "PDNSZCapacityUtilAlertSeverity": "2",
    "PDNSZRecordSetCapacityPolicyEffect": "deployIfNotExists",
    "VnetGwTunnelIngressPacketDropCountAlertState": "true",
    "AFWSNATPortUtilizationAlertState": "true",
    "ERGwExpressRouteBitsOutWindowSize": "PT5M",
    "LBGlobalBackendAvailabilityEvaluationFrequency": "PT1M",
    "ERCIRQoSDropBitsoutPerSecPolicyEffect": "deployIfNotExists",
    "ERPTxLightLevelLowAlertSeverity": "1",
    "PDNSZCapacityUtilPolicyEffect": "deployIfNotExists",
    "ERCIRQoSDropBitsoutPerSecEvaluationFrequency": "PT5M",
    "VnetGwTunnelIngressPacketDropCountPolicyEffect": "deployIfNotExists",
    "FirewallHealthWindowSize": "PT5M",
    "VPNGWTunnelIngressPacketDropCountAlertState": "true",
    "ERGwExpressRouteBitsInAlertState": "true",
    "PIPBytesInDDoSAlertSeverity": "4",
    "activityNSGDeleteAlertState": "true",
    "LBDatapathAvailabilityAlertSeverity": "0",
    "VPNGWTunnelIngressPacketDropCountPolicyEffect": "deployIfNotExists",
    "LBHealthProbeStatusWindowSize": "PT5M",
    "VnetGwTunnelEgressPacketDropMismatchWindowSize": "PT5M",
    "activityNSGDeletePolicyEffect": "deployIfNotExists",
    "VnetGwTunnelBWEvaluationFrequency": "PT1M",
    "VPNGWTunnelIngressPacketDropCountAlertSeverity": "3",
    "VnetGwTunnelEgressEvaluationFrequency": "PT5M",
    "ERGwExpressRouteCpuUtilAlertState": "true",
    "ERPRxLightLevelHighPolicyEffect": "deployIfNotExists",
    "VnetGwTunnelIngressPacketDropMismatchPolicyEffect": "deployIfNotExists",
    "PIPDDoSAttackWindowSize": "PT5M",
    "ERPTxLightLevelHighWindowSize": "PT5M",
    "ERPRxLightLevelHighEvaluationFrequency": "PT1M",
    "VNETDDOSAttackAlertState": "true",
    "VnetGwTunnelEgressPacketDropMismatchAlertSeverity": "3",
    "PDNSZRecordSetCapacityAlertSeverity": "2",
    "VnetGwExpressRouteBitsPerSecondEvaluationFrequency": "PT1M",
    "VnetGwTunnelEgressPolicyEffect": "disabled",
    "ERPLineProtocolEvaluationFrequency": "PT1M",
    "VnetGwTunnelIngressPacketDropCountEvaluationFrequency": "PT5M",
    "VnetGwTunnelBWThreshold": "1",
    "VPNGWTunnelEgressPacketDropCountPolicyEffect": "deployIfNotExists",
    "VnetGwTunnelIngressPacketDropMismatchEvaluationFrequency": "PT5M",
    "PDNSZRegistrationCapacityUtilThreshold": "80",
    "VPNGWTunnelIngressPacketDropCountFrequency": "PT5M",
    "ERGwExpressRouteBitsInWindowSize": "PT5M",
    "ERPBitsOutPerSecondPolicyEffect": "deployIfNotExists",
    "PIPBytesInDDoSEvaluationFrequency": "PT5M",
    "VPNGWIngressPolicyEffect": "disabled",
    "PDNSZRegistrationCapacityUtilPolicyEffect": "deployIfNotExists",
    "VnetGwTunnelEgressAlertState": "true",
    "VPNGwBGPPeerStatusAlertState": "true",
    "VPNGWEgressWindowSize": "PT5M",
    "PIPPacketsInDDoSEvaluationFrequency": "PT5M",
    "LBGlobalBackendAvailabilityWindowSize": "PT5M",
    "ERCIRQoSDropBitsinPerSecEvaluationFrequency": "PT5M",
    "VnetGwTunnelEgressPacketDropCountWindowSize": "PT5M",
    "VnetGwTunnelEgressPacketDropMismatchPolicyEffect": "deployIfNotExists",
    "ERCIRQoSDropBitsinPerSecAlertState": "true",
    "FirewallHealthAlertState": "true",
    "FirewallHealthEvaluationFrequency": "PT1M",
    "ERGwExpressRouteBitsOutAlertState": "true"
  },
  "scope": {
    "amba": [
      "/providers/Microsoft.Management/managementGroups/amba-connectivity"
    ]
  }
}