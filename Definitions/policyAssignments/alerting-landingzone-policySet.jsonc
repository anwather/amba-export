{
  "$schema": "https://raw.githubusercontent.com/Azure/enterprise-azure-policy-as-code/main/Schemas/policy-assignment-schema.json",
  "nodeName": "/root",
  "definitionEntry": {
    "policySetName": "Alerting-LandingZone",
    "displayName": "Deploy Azure Monitor Baseline Alerts for Landing Zone",
    "nonComplianceMessages": [
      {
        "policyDefinitionReferenceId": null,
        "message": "Alerting must be deployed to Azure services."
      }
    ]
  },
  "assignment": {
    "name": "Deploy-AMBA-LandingZone",
    "displayName": "Deploy Azure Monitor Baseline Alerts for Landing Zone",
    "description": "Initiative to deploy AMBA alerts relevant to the ALZ LandingZone management group"
  },
  "metadata": {
    "_deployed_by_amba": true
  },
  "parameters": {
    "PIPPacketsInDDoSWindowSize": "PT5M",
    "VMNetworkOutOperator": "GreaterThan",
    "VMOSDiskSpaceAlertSeverity": "2",
    "VMOSDiskSpaceDisksToInclude": [
      "C:",
      "/"
    ],
    "FDBackendHealthWindowSize": "PT5M",
    "VMNetworkInAlertState": "true",
    "VMDataDiskWriteLatencyPolicyEffect": "deployIfNotExists",
    "AGWBackendLastByteResponseTimePolicyEffect": "deployIfNotExists",
    "KVCapacityPolicyEffect": "disabled",
    "VMDataDiskWriteLatencyAutoResolveTime": "00:10:00",
    "VMOSDiskWriteLatencyFailingPeriods": "1",
    "StorageAccountAvailabilityPolicyEffect": "deployIfNotExists",
    "VMNetworkInThreshold": "10000000",
    "VMPercentCPUOperator": "GreaterThan",
    "WSFCPUPercentageAlertSeverity": "2",
    "VMPercentCPUAutoResolveTime": "00:10:00",
    "VMNetworkInNetworkInterfaceToInclude": [
      "*"
    ],
    "AGWBackendLastByteResponseTimeEvaluationFrequency": "PT1M",
    "VMOSDiskWriteLatencyOperator": "LessThan",
    "VMPercentMemoryEvaluationFrequency": "PT5M",
    "VMOSDiskReadLatencyPolicyEffect": "deployIfNotExists",
    "VMPercentCPUAutoMitigate": "true",
    "VMDataDiskReadLatencyWindowSize": "PT15M",
    "ALZMonitorResourceGroupLocation": "australiaeast",
    "KVCapacityAlertSeverity": "1",
    "CDNPPercentage5XXAlertState": "true",
    "CDNPPercentage4XXAlertSeverity": "2",
    "AGWComputeUnitsPolicyEffect": "deployIfNotExists",
    "VMDataDiskWriteLatencyFailingPeriods": "1",
    "VMHeartBeatRGOperator": "GreaterThan",
    "VMPercentCPUThreshold": "85",
    "FDBackendHealthAlertState": "true",
    "StorageAccountAvailabilityAlertSeverity": "1",
    "PIPPacketsInDDoSThreshold": "40000",
    "WSFDiskQueueLengthAlertSeverity": "2",
    "VMDataDiskSpacePolicyEffect": "deployIfNotExists",
    "LBDatapathAvailabilityEvaluationFrequency": "PT1M",
    "StorageAccountDeleteAlertState": "true",
    "VMDataDiskReadLatencyEvaluationPeriods": "1",
    "AGWResponseStatusAlertSeverity": "2",
    "WSFMemoryPercentageEvaluationFrequency": "PT1M",
    "VMDataDiskWriteLatencyAutoMitigate": "true",
    "PIPPacketsInDDoSPolicyEffect": "disabled",
    "FDBackendRequestLatencyWindowSize": "PT5M",
    "PIPVIPAvailabilityAlertState": "true",
    "KVCapacityEvaluationFrequency": "PT1M",
    "VMOSDiskReadLatencyAutoMitigate": "true",
    "AGWUnhealthyHostCountEvaluationFrequency": "PT1M",
    "VNETDDOSAttackPolicyEffect": "deployIfNotExists",
    "VMOSDiskReadLatencyWindowSize": "PT15M",
    "LBUsedSNATPortsAlertState": "true",
    "VMOSDiskWriteLatencyAlertSeverity": "2",
    "ALZMonitorResourceGroupName": "rg-amba-monitoring-001",
    "VMHeartBeatRGTimeAggregation": "Average",
    "VMPercentMemoryAlertSeverity": "2",
    "VMNetworkOutEvaluationFrequency": "PT5M",
    "PIPVIPAvailabilityAlertSeverity": "1",
    "PIPDDoSAttackEvaluationFrequency": "PT5M",
    "AGWUnhealthyHostCountAlertState": "true",
    "TMEndpointHealthPolicyEffect": "deployIfNotExists",
    "VMOSDiskSpaceAlertState": "true",
    "StorageAccountDeletePolicyEffect": "deployIfNotExists",
    "VMNetworkOutAutoResolveTime": "00:10:00",
    "KvLatencyAvailabilityWindowSize": "PT5M",
    "VMOSDiskSpaceAutoResolveTime": "00:10:00",
    "FDBackendRequestLatencyEvaluationFrequency": "PT1M",
    "CDNPOriginHealthPercentageAlertSeverity": "2",
    "AGWApplicationGatewayTotalTimePolicyEffect": "deployIfNotExists",
    "WSFDiskQueueLengthEvaluationFrequency": "PT1M",
    "KvLatencyAvailabilityAlertState": "true",
    "VMDataDiskReadLatencyAlertState": "true",
    "VMOSDiskReadLatencyAutoResolve": "true",
    "VMHeartBeatRGEvaluationFrequency": "PT5M",
    "WSFHttpQueueLengthAlertState": "true",
    "VMDataDiskSpaceAlertSeverity": "2",
    "VMOSDiskSpacePolicyEffect": "deployIfNotExists",
    "VMHeartBeatRGAutoResolveTime": "00:10:00",
    "KvLatencyAvailabilityAlertSeverity": "3",
    "KVRequestWindowSize": "PT5M",
    "LBUsedSNATPortsAlertSeverity": "1",
    "VMOSDiskWriteLatencyDisksToInclude": [
      "C:",
      "/"
    ],
    "VMNetworkInAutoResolve": "true",
    "AGWResponseStatusAlertState": "true",
    "AGWBackendLastByteResponseTimeWindowSize": "PT5M",
    "VMOSDiskSpaceOperator": "LessThan",
    "LBDatapathAvailabilityPolicyEffect": "deployIfNotExists",
    "VMDataDiskSpaceTimeAggregation": "Average",
    "AGWUnhealthyHostCountWindowSize": "PT5M",
    "VMOSDiskReadLatencyDisksToInclude": [
      "C:",
      "/"
    ],
    "VMPercentMemoryAutoResolve": "true",
    "WSFCPUPercentagePolicyEffect": "deployIfNotExists",
    "VMDataDiskReadLatencyDisksToInclude": [
      "*"
    ],
    "AGWFailedRequestsWindowSize": "PT5M",
    "WSFHttpQueueLengthAlertSeverity": "2",
    "VMDataDiskSpaceAutoResolveTime": "00:10:00",
    "VMPercentCPUPolicyEffect": "deployIfNotExists",
    "LBUsedSNATPortsPolicyEffect": "deployIfNotExists",
    "VMOSDiskReadLatencyThreshold": "30",
    "VMDataDiskSpaceDisksToInclude": [
      "*"
    ],
    "KvAvailabilityAlertSeverity": "1",
    "AGWApplicationGatewayTotalTimeAlertState": "true",
    "WSFHttpQueueLengthPolicyEffect": "deployIfNotExists",
    "KvLatencyAvailabilityThreshold": "1000",
    "VMDataDiskReadLatencyPolicyEffect": "deployIfNotExists",
    "VMOSDiskWriteLatencyAutoResolveTime": "00:10:00",
    "CDNPPercentage5XXWindowSize": "PT5M",
    "VMOSDiskSpaceWindowSize": "PT15M",
    "VMDataDiskSpaceAutoMitigate": "true",
    "KvAvailabilityWindowSize": "PT1M",
    "VMDataDiskSpaceThreshold": "10",
    "LBHealthProbeStatusAlertState": "true",
    "VMDataDiskWriteLatencyAlertState": "true",
    "activityUDRUpdateAlertState": "true",
    "WSFDiskQueueLengthAlertState": "true",
    "VMNetworkInTimeAggregation": "Average",
    "VMDataDiskWriteLatencyAutoResolve": "true",
    "CDNPPercentage5XXEvaluationFrequency": "PT1M",
    "CDNPPercentage4XXEvaluationFrequency": "PT1M",
    "VMDataDiskReadLatencyAutoMitigate": "true",
    "LBDatapathAvailabilityAlertState": "true",
    "PIPVIPAvailabilityWindowSize": "PT5M",
    "AGWBackendLastByteResponseTimeAlertState": "true",
    "VMPercentMemoryAutoResolveTime": "00:10:00",
    "VMDataDiskWriteLatencyEvaluationPeriods": "1",
    "PIPDDoSAttackThreshold": "0",
    "CDNPPercentage5XXAlertSeverity": "2",
    "AGWResponseStatusEvaluationFrequency": "PT1M",
    "KvAvailabilityPolicyEffect": "disabled",
    "CDNPOriginHealthPercentagePolicyEffect": "deployIfNotExists",
    "LBGlobalBackendAvailabilityWindowSize": "PT5M",
    "PIPPacketsInDDoSEvaluationFrequency": "PT5M",
    "VMNetworkOutThreshold": "10000000",
    "CDNPPercentage5XXPolicyEffect": "deployIfNotExists",
    "AGWFailedRequestsAlertState": "true",
    "FDBackendHealthAlertSeverity": "2",
    "LBDatapathAvailabilityWindowSize": "PT5M",
    "WSFDiskQueueLengthWindowSize": "PT5M",
    "VMDataDiskSpaceAutoResolve": "true",
    "VMOSDiskSpaceTimeAggregation": "Average",
    "LBGlobalBackendAvailabilityPolicyEffect": "deployIfNotExists",
    "PIPBytesInDDoSWindowSize": "PT5M",
    "TMEndpointHealthEvaluationFrequency": "PT1M",
    "AGWApplicationGatewayTotalTimeEvaluationFrequency": "PT1M",
    "LBGlobalBackendAvailabilityAlertSeverity": "0",
    "AGWFailedRequestsAlertSeverity": "2",
    "VMPercentCPUAlertState": "true",
    "KvAvailabilityEvaluationFrequency": "PT1M",
    "VMOSDiskReadLatencyOperator": "LessThan",
    "CDNPPercentage4XXPolicyEffect": "deployIfNotExists",
    "VMDataDiskReadLatencyComputersToInclude": [
      "*"
    ],
    "VMNetworkInEvaluationPeriods": "1",
    "AGWBackendLastByteResponseTimeAlertSeverity": "2",
    "activityNSGDeleteAlertState": "true",
    "VMPercentMemoryWindowSize": "PT15M",
    "AGWUnhealthyHostCountAlertSeverity": "2",
    "VNETDDOSAttackWindowSize": "PT5M",
    "VMNetworkInOperator": "GreaterThan",
    "VMOSDiskSpaceFailingPeriods": "1",
    "activityKVDeleteAlertState": "true",
    "VMDataDiskReadLatencyAutoResolve": "true",
    "AGWCapacityUnitsPolicyEffect": "deployIfNotExists",
    "VMOSDiskSpaceAutoResolve": "true",
    "AGWCapacityUnitsAlertSeverity": "2",
    "VMOSDiskReadLatencyComputersToInclude": [
      "*"
    ],
    "VMOSDiskReadLatencyFailingPeriods": "1",
    "LBHealthProbeStatusWindowSize": "PT5M",
    "VMOSDiskWriteLatencyThreshold": "50",
    "TMEndpointHealthAlertState": "true",
    "VMPercentMemoryAutoMitigate": "true",
    "VMPercentMemoryOperator": "LessThan",
    "StorageAccountAvailabilityThreshold": "90",
    "VMOSDiskWriteLatencyEvaluationFrequency": "PT5M",
    "VMOSDiskWriteLatencyComputersToInclude": [
      "*"
    ],
    "AGWApplicationGatewayTotalTimeAlertSeverity": "2",
    "VMDataDiskReadLatencyAlertSeverity": "2",
    "VMOSDiskWriteLatencyPolicyEffect": "deployIfNotExists",
    "VMHeartBeatRGPolicyEffect": "deployIfNotExists",
    "AGWUnhealthyHostCountPolicyEffect": "deployIfNotExists",
    "VMHeartBeatRGAutoMitigate": "true",
    "VMNetworkInComputersToInclude": [
      "*"
    ],
    "VMNetworkInEvaluationFrequency": "PT5M",
    "AGWResponseStatusPolicyEffect": "deployIfNotExists",
    "AGWCapacityUnitsEvaluationFrequency": "PT1M",
    "LBHealthProbeStatusEvaluationFrequency": "PT1M",
    "FDBackendHealthPolicyEffect": "deployIfNotExists",
    "PIPDDoSAttackWindowSize": "PT5M",
    "KvAvailabilityAlertState": "true",
    "VNETDDOSAttackAlertSeverity": "1",
    "AGWComputeUnitsAlertSeverity": "2",
    "VMOSDiskReadLatencyAlertState": "true",
    "VMOSDiskSpaceEvaluationFrequency": "PT5M",
    "VMPercentCPUTimeAggregation": "Average",
    "RVBackupHealthMonitorPolicyEffect": "modify",
    "VMDataDiskWriteLatencyEvaluationFrequency": "PT5M",
    "VMDataDiskReadLatencyTimeAggregation": "Average",
    "KVRequestAlertSeverity": "2",
    "VMDataDiskSpaceWindowSize": "PT15M",
    "WSFMemoryPercentagePolicyEffect": "deployIfNotExists",
    "VMPercentMemoryPolicyEffect": "deployIfNotExists",
    "KvLatencyAvailabilityPolicyEffect": "disabled",
    "ALZMonitorResourceGroupTags": {
      "Project": "amba-monitoring"
    },
    "LBDatapathAvailabilityAlertSeverity": "0",
    "VNETDDOSAttackAlertState": "true",
    "FDBackendHealthEvaluationFrequency": "PT1M",
    "KVRequestAlertState": "true",
    "VMOSDiskWriteLatencyTimeAggregation": "Average",
    "VMNetworkInFailingPeriods": "1",
    "VMOSDiskWriteLatencyAutoResolve": "true",
    "VMDataDiskReadLatencyFailingPeriods": "1",
    "CDNPPercentage4XXWindowSize": "PT5M",
    "VMNetworkOutEvaluationPeriods": "1",
    "VMNetworkOutComputersToInclude": [
      "*"
    ],
    "VMDataDiskWriteLatencyThreshold": "30",
    "AGWResponseStatusWindowSize": "PT5M",
    "AGWCPUUtilAlertSeverity": "2",
    "AGWFailedRequestsEvaluationFrequency": "PT1M",
    "VMOSDiskSpaceThreshold": "10",
    "StorageAccountAvailabilityFrequency": "PT5M",
    "AGWCPUUtilEvaluationFrequency": "PT1M",
    "VMPercentMemoryThreshold": "10",
    "WSFHttpQueueLengthEvaluationFrequency": "PT1M",
    "LBHealthProbeStatusPolicyEffect": "deployIfNotExists",
    "PIPBytesInDDoSEvaluationFrequency": "PT5M",
    "VMHeartBeatRGAlertSeverity": "1",
    "VMNetworkInWindowSize": "PT15M",
    "PIPDDoSAttackAlertState": "true",
    "AGWComputeUnitsAlertState": "true",
    "KVCapacityAlertState": "true",
    "KVCapacityWindowSize": "PT5M",
    "AGWCPUUtilWindowSize": "PT5M",
    "AGWCPUUtilAlertState": "true",
    "VMDataDiskSpaceAlertState": "true",
    "AGWFailedRequestsPolicyEffect": "deployIfNotExists",
    "PIPBytesInDDoSPolicyEffect": "disabled",
    "LBHealthProbeStatusAlertSeverity": "2",
    "VMDataDiskReadLatencyOperator": "LessThan",
    "PIPPacketsInDDoSAlertSeverity": "4",
    "CDNPOriginLatencyAlertState": "true",
    "AGWComputeUnitsWindowSize": "PT5M",
    "VMDataDiskReadLatencyThreshold": "30",
    "VMNetworkOutTimeAggregation": "Average",
    "VMNetworkOutNetworkInterfaceToInclude": [
      "*"
    ],
    "StorageAccountAvailabilityWindowSize": "PT5M",
    "CDNPOriginLatencyEvaluationFrequency": "PT1M",
    "LBGlobalBackendAvailabilityAlertState": "true",
    "PIPVIPAvailabilityPolicyEffect": "deployIfNotExists",
    "CDNPOriginHealthPercentageAlertState": "true",
    "VMHeartBeatRGThreshold": "10",
    "CDNPOriginHealthPercentageEvaluationFrequency": "PT1M",
    "PIPVIPAvailabilityEvaluationFrequency": "PT1M",
    "CDNPPercentage4XXAlertState": "true",
    "VMNetworkOutPolicyEffect": "deployIfNotExists",
    "KVCapacityThreshold": "75",
    "LBUsedSNATPortsEvaluationFrequency": "PT1M",
    "VMOSDiskSpaceComputersToInclude": [
      "*"
    ],
    "KVRequestEvaluationFrequency": "PT5M",
    "VMDataDiskSpaceEvaluationPeriods": "1",
    "PIPPacketsInDDoSAlertState": "true",
    "CDNPOriginLatencyWindowSize": "PT5M",
    "StorageAccountAvailabilityAlertState": "true",
    "VMDataDiskSpaceFailingPeriods": "1",
    "VMNetworkOutFailingPeriods": "1",
    "VMOSDiskWriteLatencyAlertState": "true",
    "CDNPOriginLatencyAlertSeverity": "2",
    "VMOSDiskReadLatencyEvaluationFrequency": "PT5M",
    "VMDataDiskWriteLatencyOperator": "LessThan",
    "WSFCPUPercentageEvaluationFrequency": "PT1M",
    "WSFHttpQueueLengthWindowSize": "PT5M",
    "VMDataDiskWriteLatencyTimeAggregation": "Average",
    "VMNetworkOutAutoResolve": "true",
    "VMNetworkInAlertSeverity": "2",
    "VMPercentCPUAutoResolve": "true",
    "PIPBytesInDDoSAlertSeverity": "4",
    "WSFMemoryPercentageAlertState": "true",
    "AGWCapacityUnitsWindowSize": "PT5M",
    "VMDataDiskWriteLatencyWindowSize": "PT15M",
    "TMEndpointHealthAlertSeverity": "2",
    "VNETDDOSAttackThreshold": "1",
    "WSFDiskQueueLengthPolicyEffect": "deployIfNotExists",
    "VMPercentMemoryAlertState": "true",
    "KvLatencyAvailabilityEvaluationFrequency": "PT5M",
    "VMNetworkOutWindowSize": "PT15M",
    "VNETDDOSAttackEvaluationFrequency": "PT1M",
    "LBUsedSNATPortsWindowSize": "PT5M",
    "CDNPOriginHealthPercentageWindowSize": "PT5M",
    "VMOSDiskWriteLatencyEvaluationPeriods": "1",
    "PIPBytesInDDoSAlertState": "true",
    "FDBackendRequestLatencyPolicyEffect": "deployIfNotExists",
    "PIPDDoSAttackAlertSeverity": "1",
    "VMPercentCPUEvaluationFrequency": "PT5M",
    "WSFCPUPercentageWindowSize": "PT5M",
    "VMDataDiskWriteLatencyAlertSeverity": "2",
    "VMDataDiskSpaceOperator": "LessThan",
    "VMNetworkOutAutoMitigate": "true",
    "WSFCPUPercentageAlertState": "true",
    "PIPDDoSAttackPolicyEffect": "deployIfNotExists",
    "VMHeartBeatRGWindowSize": "PT15M",
    "VMNetworkInPolicyEffect": "deployIfNotExists",
    "AGWCapacityUnitsAlertState": "true",
    "PIPVIPAvailabilityThreshold": "1",
    "WSFMemoryPercentageWindowSize": "PT5M",
    "LBGlobalBackendAvailabilityEvaluationFrequency": "PT1M",
    "VMDataDiskWriteLatencyComputersToInclude": [
      "*"
    ],
    "VMOSDiskSpaceAutoMitigate": "true",
    "WSFMemoryPercentageAlertSeverity": "2",
    "VMPercentCPUAlertSeverity": "2",
    "VMOSDiskReadLatencyTimeAggregation": "Average",
    "VMPercentCPUWindowSize": "PT15M",
    "VMOSDiskWriteLatencyAutoMitigate": "true",
    "AGWCPUUtilPolicyEffect": "deployIfNotExists",
    "VMDataDiskSpaceEvaluationFrequency": "PT5M",
    "AGWApplicationGatewayTotalTimeWindowSize": "PT5M",
    "KVAvailabilityThreshold": "20",
    "VMDataDiskReadLatencyEvaluationFrequency": "PT5M",
    "FDBackendRequestLatencyAlertState": "true",
    "VMOSDiskWriteLatencyWindowSize": "PT15M",
    "VMOSDiskReadLatencyAlertSeverity": "2",
    "FDBackendRequestLatencyAlertSeverity": "2",
    "VMOSDiskReadLatencyAutoResolveTime": "00:10:00",
    "VMHeartBeatRGAutoResolve": "true",
    "VMNetworkOutAlertSeverity": "2",
    "PIPBytesInDDoSThreshold": "8000000",
    "AGWComputeUnitsEvaluationFrequency": "PT1M",
    "VMDataDiskReadLatencyAutoResolveTime": "00:10:00",
    "KVRequestPolicyEffect": "disabled",
    "VMOSDiskReadLatencyEvaluationPeriods": "1",
    "VMPercentMemoryTimeAggregation": "Average",
    "VMNetworkOutAlertState": "true",
    "VMHeartBeatRGAlertState": "true",
    "CDNPOriginLatencyPolicyEffect": "disabled",
    "VMDataDiskWriteLatencyDisksToInclude": [
      "*"
    ],
    "VMNetworkInAutoMitigate": "true",
    "VMNetworkInAutoResolveTime": "00:10:00",
    "TMEndpointHealthWindowSize": "PT5M",
    "VMOSDiskSpaceEvaluationPeriods": "1"
  },
  "scope": {
    "amba": [
      "/providers/Microsoft.Management/managementGroups/amba-landingzones"
    ]
  }
}