{
  "$schema": "https://raw.githubusercontent.com/Azure/enterprise-azure-policy-as-code/main/Schemas/policy-assignment-schema.json",
  "nodeName": "/root",
  "definitionEntry": {
    "policySetName": "Alerting-LandingZone",
    "displayName": "Deploy Azure Monitor Baseline Alerts for Landing Zone",
    "nonComplianceMessages": [
      {
        "policyDefinitionReferenceId": null,
        "message": "Alerting must be deployed to Azure services."
      }
    ]
  },
  "assignment": {
    "name": "Deploy-AMBA-LandingZone",
    "displayName": "Deploy Azure Monitor Baseline Alerts for Landing Zone",
    "description": "Initiative to deploy AMBA alerts relevant to the ALZ LandingZone management group"
  },
  "metadata": {
    "_deployed_by_amba": true
  },
  "parameters": {
    "agwApplicationGatewayTotalTimeAlertSeverity": "2",
    "kvLatencyAvailabilityEvaluationFrequency": "PT5M",
    "kvLatencyAvailabilityAlertState": "true",
    "vmDataDiskReadLatencyThreshold": "30",
    "vmosDiskWriteLatencyAlertSeverity": "2",
    "vmHeartBeatRGEvaluationFrequency": "PT5M",
    "pipBytesInDDoSEvaluationFrequency": "PT5M",
    "activityKVDeleteAlertState": "true",
    "vmDataDiskWriteLatencyComputersToInclude": [
      "*"
    ],
    "vmNetworkOutAutoResolveTime": "00:10:00",
    "vmosDiskReadLatencyTimeAggregation": "Average",
    "agwCapacityUnitsPolicyEffect": "deployIfNotExists",
    "vmosDiskSpaceEvaluationPeriods": "1",
    "pipdDoSAttackAlertState": "true",
    "vmNetworkOutAlertState": "true",
    "lbGlobalBackendAvailabilityWindowSize": "PT5M",
    "vmDataDiskWriteLatencyAlertState": "true",
    "pipvipAvailabilityWindowSize": "PT5M",
    "kvRequestEvaluationFrequency": "PT5M",
    "agwFailedRequestsAlertState": "true",
    "agwUnhealthyHostCountPolicyEffect": "deployIfNotExists",
    "kvLatencyAvailabilityPolicyEffect": "disabled",
    "storageAccountAvailabilityThreshold": "90",
    "vmosDiskSpaceWindowSize": "PT15M",
    "pipPacketsInDDoSWindowSize": "PT5M",
    "lbGlobalBackendAvailabilityAlertSeverity": "0",
    "vmNetworkOutAlertSeverity": "2",
    "pipdDoSAttackThreshold": "0",
    "activityUDRUpdateAlertState": "true",
    "vnetddosAttackEvaluationFrequency": "PT1M",
    "vmosDiskWriteLatencyTimeAggregation": "Average",
    "vmNetworkInOperator": "GreaterThan",
    "lbHealthProbeStatusEvaluationFrequency": "PT1M",
    "agwcpuUtilAlertState": "true",
    "agwFailedRequestsWindowSize": "PT5M",
    "vmosDiskWriteLatencyPolicyEffect": "deployIfNotExists",
    "pipBytesInDDoSAlertSeverity": "4",
    "vmPercentCPUAutoResolve": "true",
    "vmDataDiskSpaceAutoResolve": "true",
    "vmPercentMemoryAutoResolve": "true",
    "lbDatapathAvailabilityAlertSeverity": "0",
    "lbUsedSNATPortsEvaluationFrequency": "PT1M",
    "vmDataDiskReadLatencyAlertState": "true",
    "vmHeartBeatRGThreshold": "10",
    "vmosDiskReadLatencyThreshold": "30",
    "lbDatapathAvailabilityWindowSize": "PT5M",
    "kvAvailabilityAlertState": "true",
    "lbDatapathAvailabilityPolicyEffect": "deployIfNotExists",
    "vmPercentMemoryAutoMitigate": "true",
    "vmPercentCPUEvaluationFrequency": "PT5M",
    "pipPacketsInDDoSAlertSeverity": "4",
    "vmNetworkOutAutoResolve": "true",
    "agwBackendLastByteResponseTimeAlertSeverity": "2",
    "pipPacketsInDDoSPolicyEffect": "disabled",
    "vmHeartBeatRGWindowSize": "PT15M",
    "agwApplicationGatewayTotalTimeEvaluationFrequency": "PT1M",
    "vmNetworkInComputersToInclude": [
      "*"
    ],
    "vmNetworkOutPolicyEffect": "deployIfNotExists",
    "vmosDiskSpaceAlertState": "true",
    "vmNetworkInThreshold": "10000000",
    "pipvipAvailabilityEvaluationFrequency": "PT1M",
    "agwApplicationGatewayTotalTimeAlertState": "true",
    "vmosDiskWriteLatencyEvaluationPeriods": "1",
    "vmPercentCPUTimeAggregation": "Average",
    "vmDataDiskReadLatencyAlertSeverity": "2",
    "kvAvailabilityPolicyEffect": "disabled",
    "pipBytesInDDoSPolicyEffect": "disabled",
    "vmosDiskSpaceAutoMitigate": "true",
    "kvCapacityPolicyEffect": "disabled",
    "vmNetworkInEvaluationFrequency": "PT5M",
    "lbUsedSNATPortsAlertState": "true",
    "agwcpuUtilWindowSize": "PT5M",
    "storageAccountAvailabilityWindowSize": "PT5M",
    "agwResponseStatusAlertSeverity": "2",
    "vmDataDiskWriteLatencyTimeAggregation": "Average",
    "vmHeartBeatRGAlertSeverity": "1",
    "pipPacketsInDDoSEvaluationFrequency": "PT5M",
    "vmosDiskReadLatencyAutoResolveTime": "00:10:00",
    "rvBackupHealthMonitorPolicyEffect": "modify",
    "vmNetworkOutAutoMitigate": "true",
    "vmPercentMemoryAlertState": "true",
    "vmosDiskSpaceDisksToInclude": [
      "C:",
      "/"
    ],
    "agwApplicationGatewayTotalTimeWindowSize": "PT5M",
    "vmDataDiskReadLatencyComputersToInclude": [
      "*"
    ],
    "vmDataDiskWriteLatencyFailingPeriods": "1",
    "vmDataDiskReadLatencyDisksToInclude": [
      "*"
    ],
    "vmDataDiskSpacePolicyEffect": "deployIfNotExists",
    "vmDataDiskWriteLatencyAutoResolve": "true",
    "agwFailedRequestsPolicyEffect": "deployIfNotExists",
    "lbDatapathAvailabilityEvaluationFrequency": "PT1M",
    "vmosDiskReadLatencyAlertSeverity": "2",
    "vmosDiskSpaceEvaluationFrequency": "PT5M",
    "vmosDiskReadLatencyComputersToInclude": [
      "*"
    ],
    "vmNetworkOutWindowSize": "PT15M",
    "vmNetworkInAutoResolve": "true",
    "pipPacketsInDDoSThreshold": "40000",
    "vmosDiskWriteLatencyAutoResolve": "true",
    "vmPercentMemoryPolicyEffect": "deployIfNotExists",
    "vnetddosAttackThreshold": "1",
    "vmNetworkOutNetworkInterfaceToInclude": [
      "*"
    ],
    "vmDataDiskWriteLatencyThreshold": "30",
    "kvAvailabilityWindowSize": "PT1M",
    "vmosDiskWriteLatencyOperator": "LessThan",
    "vmosDiskWriteLatencyAlertState": "true",
    "vmosDiskSpaceFailingPeriods": "1",
    "vmPercentMemoryAutoResolveTime": "00:10:00",
    "vmNetworkInEvaluationPeriods": "1",
    "agwComputeUnitsAlertSeverity": "2",
    "pipvipAvailabilityThreshold": "1",
    "vmosDiskWriteLatencyThreshold": "50",
    "vmDataDiskReadLatencyPolicyEffect": "deployIfNotExists",
    "vmHeartBeatRGAutoResolveTime": "00:10:00",
    "vmosDiskWriteLatencyAutoMitigate": "true",
    "alzMonitorResourceGroupTags": {
      "Project": "alz-monitor"
    },
    "vmosDiskSpacePolicyEffect": "deployIfNotExists",
    "pipPacketsInDDoSAlertState": "true",
    "agwBackendLastByteResponseTimeAlertState": "true",
    "kvRequestAlertState": "true",
    "agwComputeUnitsPolicyEffect": "deployIfNotExists",
    "vmDataDiskSpaceAlertState": "true",
    "vmNetworkInAlertState": "true",
    "storageAccountAvailabilityPolicyEffect": "deployIfNotExists",
    "vmDataDiskWriteLatencyAlertSeverity": "2",
    "agwBackendLastByteResponseTimeWindowSize": "PT5M",
    "lbHealthProbeStatusPolicyEffect": "deployIfNotExists",
    "vmDataDiskReadLatencyAutoResolve": "true",
    "kvCapacityThreshold": "75",
    "agwCapacityUnitsAlertState": "true",
    "vmDataDiskSpaceFailingPeriods": "1",
    "vmDataDiskReadLatencyFailingPeriods": "1",
    "vmDataDiskWriteLatencyEvaluationFrequency": "PT5M",
    "agwUnhealthyHostCountAlertSeverity": "2",
    "vmDataDiskReadLatencyEvaluationFrequency": "PT5M",
    "lbGlobalBackendAvailabilityPolicyEffect": "deployIfNotExists",
    "kvRequestWindowSize": "PT5M",
    "vmosDiskWriteLatencyFailingPeriods": "1",
    "alzMonitorResourceGroupLocation": "eastus",
    "vmosDiskWriteLatencyEvaluationFrequency": "PT5M",
    "vmDataDiskSpaceEvaluationPeriods": "1",
    "vnetddosAttackWindowSize": "PT5M",
    "pipvipAvailabilityPolicyEffect": "deployIfNotExists",
    "vmNetworkOutEvaluationPeriods": "1",
    "vmNetworkInPolicyEffect": "deployIfNotExists",
    "agwcpuUtilPolicyEffect": "deployIfNotExists",
    "vmNetworkInAlertSeverity": "2",
    "vmosDiskSpaceAutoResolveTime": "00:10:00",
    "vmDataDiskSpaceOperator": "LessThan",
    "agwCapacityUnitsWindowSize": "PT5M",
    "agwBackendLastByteResponseTimeEvaluationFrequency": "PT1M",
    "pipBytesInDDoSThreshold": "8000000",
    "agwCapacityUnitsEvaluationFrequency": "PT1M",
    "vmDataDiskSpaceTimeAggregation": "Average",
    "vmosDiskWriteLatencyComputersToInclude": [
      "*"
    ],
    "vmPercentMemoryAlertSeverity": "2",
    "storageAccountAvailabilityAlertSeverity": "1",
    "vmPercentCPUAlertState": "true",
    "vmosDiskSpaceTimeAggregation": "Average",
    "agwBackendLastByteResponseTimePolicyEffect": "deployIfNotExists",
    "vmHeartBeatRGPolicyEffect": "deployIfNotExists",
    "agwCapacityUnitsAlertSeverity": "2",
    "agwUnhealthyHostCountEvaluationFrequency": "PT1M",
    "lbUsedSNATPortsWindowSize": "PT5M",
    "agwComputeUnitsWindowSize": "PT5M",
    "vmNetworkOutTimeAggregation": "Average",
    "vmNetworkOutOperator": "GreaterThan",
    "vmDataDiskReadLatencyOperator": "LessThan",
    "vmNetworkInTimeAggregation": "Average",
    "vmosDiskReadLatencyEvaluationPeriods": "1",
    "vmDataDiskReadLatencyWindowSize": "PT15M",
    "vmPercentMemoryOperator": "LessThan",
    "vmosDiskSpaceThreshold": "10",
    "vmPercentMemoryEvaluationFrequency": "PT5M",
    "vmPercentCPUWindowSize": "PT15M",
    "vmosDiskWriteLatencyAutoResolveTime": "00:10:00",
    "vmNetworkInAutoResolveTime": "00:10:00",
    "vmNetworkInAutoMitigate": "true",
    "agwApplicationGatewayTotalTimePolicyEffect": "deployIfNotExists",
    "storageAccountAvailabilityAlertState": "true",
    "vmosDiskReadLatencyAlertState": "true",
    "lbDatapathAvailabilityAlertState": "true",
    "vmPercentMemoryWindowSize": "PT15M",
    "vmDataDiskSpaceAutoResolveTime": "00:10:00",
    "vmPercentCPUOperator": "GreaterThan",
    "agwResponseStatusPolicyEffect": "deployIfNotExists",
    "vmPercentCPUAlertSeverity": "2",
    "vmDataDiskSpaceAlertSeverity": "2",
    "vmDataDiskReadLatencyTimeAggregation": "Average",
    "pipBytesInDDoSWindowSize": "PT5M",
    "vmDataDiskSpaceDisksToInclude": [
      "*"
    ],
    "vmosDiskWriteLatencyDisksToInclude": [
      "C:",
      "/"
    ],
    "vmHeartBeatRGOperator": "GreaterThan",
    "pipBytesInDDoSAlertState": "true",
    "vmNetworkInWindowSize": "PT15M",
    "vnetddosAttackAlertSeverity": "1",
    "lbHealthProbeStatusAlertSeverity": "2",
    "vmPercentCPUThreshold": "85",
    "agwComputeUnitsEvaluationFrequency": "PT1M",
    "vmNetworkOutFailingPeriods": "1",
    "vmHeartBeatRGAlertState": "true",
    "vmPercentMemoryTimeAggregation": "Average",
    "lbGlobalBackendAvailabilityEvaluationFrequency": "PT1M",
    "storageAccountAvailabilityFrequency": "PT5M",
    "vmosDiskReadLatencyDisksToInclude": [
      "C:",
      "/"
    ],
    "activityNSGDeleteAlertState": "true",
    "vmDataDiskWriteLatencyAutoMitigate": "true",
    "vmNetworkOutComputersToInclude": [
      "*"
    ],
    "pipvipAvailabilityAlertState": "true",
    "kvLatencyAvailabilityThreshold": "1000",
    "agwFailedRequestsEvaluationFrequency": "PT1M",
    "vmDataDiskReadLatencyEvaluationPeriods": "1",
    "agwcpuUtilEvaluationFrequency": "PT1M",
    "pipdDoSAttackEvaluationFrequency": "PT5M",
    "lbGlobalBackendAvailabilityAlertState": "true",
    "lbHealthProbeStatusWindowSize": "PT5M",
    "vmosDiskSpaceAlertSeverity": "2",
    "kvCapacityAlertSeverity": "1",
    "vmNetworkOutThreshold": "10000000",
    "vmDataDiskWriteLatencyWindowSize": "PT15M",
    "vmDataDiskSpaceEvaluationFrequency": "PT5M",
    "vmosDiskReadLatencyFailingPeriods": "1",
    "agwUnhealthyHostCountWindowSize": "PT5M",
    "vmDataDiskSpaceWindowSize": "PT15M",
    "vmosDiskSpaceComputersToInclude": [
      "*"
    ],
    "vmPercentCPUAutoResolveTime": "00:10:00",
    "agwResponseStatusWindowSize": "PT5M",
    "vnetddosAttackPolicyEffect": "deployIfNotExists",
    "kvAvailabilityThreshold": "20",
    "alzMonitorResourceGroupName": "rg-amba-monitor",
    "pipdDoSAttackAlertSeverity": "1",
    "agwResponseStatusEvaluationFrequency": "PT1M",
    "vmDataDiskWriteLatencyPolicyEffect": "deployIfNotExists",
    "vmNetworkOutEvaluationFrequency": "PT5M",
    "vmDataDiskReadLatencyAutoMitigate": "true",
    "vmDataDiskSpaceThreshold": "10",
    "pipvipAvailabilityAlertSeverity": "1",
    "vnetddosAttackAlertState": "true",
    "vmPercentCPUPolicyEffect": "deployIfNotExists",
    "vmosDiskReadLatencyAutoResolve": "true",
    "vmDataDiskWriteLatencyDisksToInclude": [
      "*"
    ],
    "vmNetworkInNetworkInterfaceToInclude": [
      "*"
    ],
    "kvLatencyAvailabilityWindowSize": "PT5M",
    "vmosDiskSpaceAutoResolve": "true",
    "vmPercentCPUAutoMitigate": "true",
    "vmosDiskReadLatencyOperator": "LessThan",
    "kvAvailabilityEvaluationFrequency": "PT1M",
    "kvLatencyAvailabilityAlertSeverity": "3",
    "kvRequestAlertSeverity": "2",
    "vmDataDiskSpaceAutoMitigate": "true",
    "vmDataDiskWriteLatencyEvaluationPeriods": "1",
    "vmosDiskReadLatencyWindowSize": "PT15M",
    "kvCapacityWindowSize": "PT5M",
    "agwcpuUtilAlertSeverity": "2",
    "kvCapacityEvaluationFrequency": "PT1M",
    "vmHeartBeatRGAutoResolve": "true",
    "vmHeartBeatRGTimeAggregation": "Average",
    "agwFailedRequestsAlertSeverity": "2",
    "vmDataDiskWriteLatencyOperator": "LessThan",
    "vmNetworkInFailingPeriods": "1",
    "kvRequestPolicyEffect": "disabled",
    "pipdDoSAttackPolicyEffect": "deployIfNotExists",
    "lbUsedSNATPortsAlertSeverity": "1",
    "vmDataDiskReadLatencyAutoResolveTime": "00:10:00",
    "vmosDiskReadLatencyEvaluationFrequency": "PT5M",
    "vmDataDiskWriteLatencyAutoResolveTime": "00:10:00",
    "kvAvailabilityAlertSeverity": "1",
    "lbHealthProbeStatusAlertState": "true",
    "lbUsedSNATPortsPolicyEffect": "deployIfNotExists",
    "vmosDiskSpaceOperator": "LessThan",
    "vmHeartBeatRGAutoMitigate": "true",
    "vmosDiskReadLatencyPolicyEffect": "deployIfNotExists",
    "pipdDoSAttackWindowSize": "PT5M",
    "vmosDiskReadLatencyAutoMitigate": "true",
    "agwComputeUnitsAlertState": "true",
    "vmosDiskWriteLatencyWindowSize": "PT15M",
    "agwResponseStatusAlertState": "true",
    "kvCapacityAlertState": "true",
    "agwUnhealthyHostCountAlertState": "true",
    "vmPercentMemoryThreshold": "10"
  },
  "scope": {
    "amba": [
      "/providers/Microsoft.Management/managementGroups/amba-landingzones"
    ]
  }
}