{
  "$schema": "https://raw.githubusercontent.com/Azure/enterprise-azure-policy-as-code/main/Schemas/policy-assignment-schema.json",
  "nodeName": "/root",
  "definitionEntry": {
    "policySetName": "Alerting-VM",
    "displayName": "Deploy Azure Monitor Baseline Alerts for Virtual Machines",
    "nonComplianceMessages": [
      {
        "policyDefinitionReferenceId": null,
        "message": "Alerting must be deployed to Azure services."
      }
    ]
  },
  "assignment": {
    "name": "Deploy-AMBA-VM",
    "displayName": "Deploy Azure Monitor Baseline Alerts for Virtual Machines",
    "description": "This initiative deploys Azure Monitor Baseline Alerts to monitor Azure Virtual Machines."
  },
  "metadata": {
    "_deployed_by_amba": true
  },
  "parameters": {
    "VMOSDiskWriteLatencyAutoResolveTime": "00:10:00",
    "ALZMonitorResourceGroupTags": {
      "Project": "amba-monitoring"
    },
    "VMHeartBeatRGThreshold": "10",
    "VMOSDiskSpaceComputersToInclude": [
      "*"
    ],
    "VMDataDiskReadLatencyEvaluationPeriods": "1",
    "ALZManagementSubscriptionId": "8da8d616-a90e-446a-9098-ad7381ce56a7",
    "VMDataDiskReadLatencyTimeAggregation": "Count",
    "VMNetworkInOperator": "GreaterThan",
    "VMDataDiskReadLatencyAlertSeverity": "2",
    "VMOSDiskReadLatencyAlertSeverity": "2",
    "VMOSDiskWriteLatencyEvaluationPeriods": "1",
    "VMDataDiskSpaceTimeAggregation": "Count",
    "VMNetworkInFailingPeriods": "1",
    "VMPercentCPUAlertState": "true",
    "VMPercentMemoryAutoResolve": "true",
    "VMDataDiskWriteLatencyEvaluationFrequency": "PT5M",
    "VMDataDiskSpaceThreshold": "10",
    "VMPercentCPUFailingPeriods": "1",
    "VMDataDiskSpaceAlertState": "true",
    "VMOSDiskReadLatencyAutoMitigate": "true",
    "VMNetworkOutAutoResolve": "true",
    "VMNetworkInEvaluationFrequency": "PT5M",
    "VMOSDiskSpaceAlertSeverity": "2",
    "VMDataDiskSpaceEvaluationFrequency": "PT5M",
    "VMOSDiskSpaceThreshold": "10",
    "VMNetworkInTimeAggregation": "Count",
    "VMNetworkOutAutoResolveTime": "00:10:00",
    "VMPercentMemoryFailingPeriods": "1",
    "ALZMonitorDisableTagValues": [
      "true",
      "Test",
      "Dev",
      "Sandbox"
    ],
    "VMDataDiskSpaceAlertSeverity": "2",
    "VMOSDiskSpaceAutoResolve": "true",
    "VMHeartBeatRGWindowSize": "PT6H",
    "VMDataDiskReadLatencyOperator": "GreaterThan",
    "VMOSDiskWriteLatencyEvaluationFrequency": "PT5M",
    "VMOSDiskWriteLatencyAutoMitigate": "true",
    "VMDataDiskWriteLatencyAlertSeverity": "2",
    "VMPercentMemoryOperator": "GreaterThan",
    "VMPercentCPUPolicyEffect": "deployIfNotExists",
    "VMDataDiskReadLatencyEvaluationFrequency": "PT5M",
    "VMOSDiskWriteLatencyAlertState": "true",
    "VMDataDiskWriteLatencyWindowSize": "PT15M",
    "VMHeartBeatRGAutoMitigate": "true",
    "VMNetworkInAutoResolveTime": "00:10:00",
    "VMNetworkOutEvaluationFrequency": "PT5M",
    "VMDataDiskReadLatencyFailingPeriods": "1",
    "VMNetworkInAlertState": "true",
    "VMDataDiskSpaceEvaluationPeriods": "1",
    "VMOSDiskWriteLatencyTimeAggregation": "Count",
    "VMOSDiskReadLatencyFailingPeriods": "1",
    "VMOSDiskWriteLatencyAutoResolve": "true",
    "VMDataDiskWriteLatencyAutoMitigate": "true",
    "VMNetworkInAutoResolve": "true",
    "VMPercentCPUAutoResolve": "true",
    "VMDataDiskWriteLatencyComputersToInclude": [
      "*"
    ],
    "VMDataDiskWriteLatencyThreshold": "30",
    "VMPercentMemoryWindowSize": "PT15M",
    "VMOSDiskSpaceAutoResolveTime": "00:10:00",
    "VMDataDiskWriteLatencyTimeAggregation": "Count",
    "VMDataDiskReadLatencyWindowSize": "PT15M",
    "VMNetworkOutAlertState": "true",
    "VMOSDiskSpaceTimeAggregation": "Count",
    "VMDataDiskWriteLatencyOperator": "GreaterThan",
    "VMOSDiskSpaceEvaluationFrequency": "PT5M",
    "VMPercentMemoryThreshold": "10",
    "VMNetworkOutTimeAggregation": "Count",
    "VMDataDiskSpacePolicyEffect": "deployIfNotExists",
    "VMOSDiskReadLatencyEvaluationFrequency": "PT5M",
    "ALZMonitorDisableTagName": "MonitorDisable",
    "VMOSDiskWriteLatencyThreshold": "30",
    "VMDataDiskWriteLatencyAutoResolveTime": "00:10:00",
    "VMNetworkInPolicyEffect": "deployIfNotExists",
    "VMNetworkOutPolicyEffect": "deployIfNotExists",
    "VMHeartBeatRGPolicyEffect": "deployIfNotExists",
    "VMNetworkOutThreshold": "10000000",
    "VMNetworkOutComputersToInclude": [
      "*"
    ],
    "VMHeartBeatRGFailingPeriods": "1",
    "VMPercentMemoryAlertState": "true",
    "VMPercentCPUOperator": "GreaterThan",
    "VMDataDiskSpaceOperator": "GreaterThan",
    "VMDataDiskReadLatencyAutoMitigate": "true",
    "VMOSDiskSpaceAutoMitigate": "true",
    "VMNetworkOutAlertSeverity": "2",
    "VMNetworkInEvaluationPeriods": "1",
    "VMOSDiskWriteLatencyAlertSeverity": "2",
    "VMOSDiskWriteLatencyWindowSize": "PT15M",
    "VMOSDiskReadLatencyOperator": "GreaterThan",
    "VMPercentMemoryEvaluationFrequency": "PT5M",
    "VMDataDiskSpaceAutoMitigate": "true",
    "VMDataDiskSpaceAutoResolve": "true",
    "VMDataDiskWriteLatencyEvaluationPeriods": "1",
    "VMPercentCPUTimeAggregation": "Count",
    "VMHeartBeatRGAutoResolve": "true",
    "VMOSDiskSpaceFailingPeriods": "1",
    "ALZMonitorResourceGroupLocation": "eastus",
    "VMHeartBeatRGTimeAggregation": "Count",
    "VMHeartBeatRGAlertState": "true",
    "VMDataDiskReadLatencyPolicyEffect": "deployIfNotExists",
    "VMHeartBeatRGEvaluationFrequency": "PT5M",
    "VMHeartBeatRGAutoResolveTime": "00:10:00",
    "BYOUserAssignedManagedIdentityResourceId": "",
    "VMNetworkInThreshold": "10000000",
    "VMNetworkInAutoMitigate": "true",
    "VMOSDiskReadLatencyWindowSize": "PT15M",
    "VMOSDiskReadLatencyComputersToInclude": [
      "*"
    ],
    "VMDataDiskReadLatencyAutoResolve": "true",
    "VMPercentCPUWindowSize": "PT15M",
    "VMHeartBeatRGComputersToInclude": [
      "*"
    ],
    "VMOSDiskWriteLatencyOperator": "GreaterThan",
    "VMPercentMemoryTimeAggregation": "Count",
    "VMNetworkOutAutoMitigate": "true",
    "VMPercentCPUEvaluationFrequency": "PT5M",
    "VMOSDiskReadLatencyAlertState": "true",
    "VMPercentMemoryAlertSeverity": "2",
    "VMPercentMemoryAutoMitigate": "true",
    "VMDataDiskSpaceWindowSize": "PT15M",
    "VMOSDiskSpaceOperator": "GreaterThan",
    "VMDataDiskReadLatencyComputersToInclude": [
      "*"
    ],
    "VMNetworkOutWindowSize": "PT15M",
    "VMOSDiskSpaceEvaluationPeriods": "1",
    "VMOSDiskReadLatencyAutoResolve": "true",
    "VMDataDiskSpaceFailingPeriods": "1",
    "VMDataDiskReadLatencyAutoResolveTime": "00:10:00",
    "VMOSDiskReadLatencyAutoResolveTime": "00:10:00",
    "VMOSDiskReadLatencyEvaluationPeriods": "1",
    "VMHeartBeatRGAlertSeverity": "1",
    "VMNetworkInWindowSize": "PT15M",
    "VMOSDiskReadLatencyTimeAggregation": "Count",
    "VMOSDiskSpacePolicyEffect": "deployIfNotExists",
    "VMOSDiskWriteLatencyFailingPeriods": "1",
    "VMNetworkInAlertSeverity": "2",
    "VMPercentCPUAutoMitigate": "true",
    "ALZMonitorResourceGroupName": "rg-amba-monitoring-001",
    "VMNetworkOutEvaluationPeriods": "1",
    "VMNetworkOutFailingPeriods": "1",
    "ALZUserAssignedManagedIdentityName": "id-amba-prod-001",
    "VMDataDiskSpaceAutoResolveTime": "00:10:00",
    "VMDataDiskReadLatencyThreshold": "30",
    "VMPercentCPUAutoResolveTime": "00:10:00",
    "VMPercentCPUAlertSeverity": "2",
    "VMDataDiskWriteLatencyPolicyEffect": "deployIfNotExists",
    "VMOSDiskReadLatencyPolicyEffect": "deployIfNotExists",
    "VMPercentMemoryAutoResolveTime": "00:10:00",
    "VMDataDiskWriteLatencyAlertState": "true",
    "VMDataDiskWriteLatencyAutoResolve": "true",
    "VMHeartBeatRGOperator": "GreaterThan",
    "VMOSDiskWriteLatencyComputersToInclude": [
      "*"
    ],
    "VMOSDiskSpaceAlertState": "true",
    "VMPercentCPUThreshold": "85",
    "VMNetworkOutOperator": "GreaterThan",
    "VMPercentMemoryPolicyEffect": "deployIfNotExists",
    "VMDataDiskReadLatencyAlertState": "true",
    "VMOSDiskReadLatencyThreshold": "30",
    "VMOSDiskWriteLatencyPolicyEffect": "deployIfNotExists",
    "VMDataDiskWriteLatencyFailingPeriods": "1",
    "VMNetworkInComputersToInclude": [
      "*"
    ],
    "VMOSDiskSpaceWindowSize": "PT15M"
  },
  "scope": {
    "amba": [
      "/providers/Microsoft.Management/managementGroups/amba-platform",
      "/providers/Microsoft.Management/managementGroups/amba-landingzones"
    ]
  }
}