{
  "$schema": "https://raw.githubusercontent.com/Azure/enterprise-azure-policy-as-code/main/Schemas/policy-assignment-schema.json",
  "nodeName": "/root",
  "definitionEntry": {
    "policySetName": "Alerting-HybridVM",
    "displayName": "Deploy Azure Monitor Baseline Alerts for Hybrid Virtual Machines",
    "nonComplianceMessages": [
      {
        "policyDefinitionReferenceId": null,
        "message": "Alerting must be deployed to Azure services."
      }
    ]
  },
  "assignment": {
    "name": "Deploy-AMBA-HybridVM",
    "displayName": "Deploy Azure Monitor Baseline Alerts for Hybrid Virtual Machines",
    "description": "This initiative deploys Azure Monitor Baseline Alerts to monitor Azure Arc-enabled Servers."
  },
  "metadata": {
    "_deployed_by_amba": true
  },
  "parameters": {
    "HybridVMOSDiskSpaceAutoResolveTime": "00:10:00",
    "ALZMonitorResourceGroupName": "rg-amba-monitoring-001",
    "HybridVMDataDiskReadLatencyComputersToInclude": [
      "*"
    ],
    "HybridVMDataDiskReadLatencyAlertSeverity": "2",
    "HybridVMDataDiskWriteLatencyEvaluationPeriods": "1",
    "HybridVMDataDiskWriteLatencyPolicyEffect": "deployIfNotExists",
    "HybridVMPercentMemoryOperator": "GreaterThan",
    "HybridVMHeartBeatRGTimeAggregation": "Count",
    "HybridVMDataDiskSpaceAutoResolveTime": "00:10:00",
    "HybridVMDisconnectedAlertWindowSize": "P1D",
    "HybridVMNetworkInAutoResolveTime": "00:10:00",
    "HybridVMPercentMemoryWindowSize": "PT15M",
    "HybridVMOSDiskWriteLatencyAlertSeverity": "2",
    "HybridVMDisconnectedAlertEvaluationPeriods": "1",
    "HybridVMDataDiskReadLatencyAutoResolve": "true",
    "HybridVMPercentCPUEvaluationFrequency": "PT5M",
    "HybridVMDataDiskReadLatencyTimeAggregation": "Count",
    "HybridVMDataDiskSpaceOperator": "GreaterThan",
    "HybridVMPercentMemoryAutoResolve": "true",
    "HybridVMNetworkInAlertState": "true",
    "HybridVMHeartBeatRGAlertState": "true",
    "HybridVMNetworkOutAlertState": "true",
    "HybridVMNetworkInEvaluationFrequency": "PT5M",
    "HybridVMPercentMemoryTimeAggregation": "Count",
    "HybridVMHeartBeatRGPolicyEffect": "deployIfNotExists",
    "HybridVMDataDiskReadLatencyAutoResolveTime": "00:10:00",
    "HybridVMOSDiskWriteLatencyAutoMitigate": "true",
    "HybridVMDataDiskSpaceEvaluationPeriods": "1",
    "HybridVMDataDiskSpaceThreshold": "10",
    "HybridVMNetworkInWindowSize": "PT15M",
    "HybridVMHeartBeatRGAutoResolveTime": "00:10:00",
    "HybridVMHeartBeatRGAutoResolve": "true",
    "HybridVMPercentMemoryAutoResolveTime": "00:10:00",
    "HybridVMOSDiskWriteLatencyTimeAggregation": "Count",
    "HybridVMNetworkOutOperator": "GreaterThan",
    "HybridVMOSDiskWriteLatencyAutoResolve": "true",
    "HybridVMOSDiskWriteLatencyAlertState": "true",
    "HybridVMPercentMemoryEvaluationFrequency": "PT5M",
    "HybridVMHeartBeatRGOperator": "GreaterThan",
    "HybridVMPercentMemoryAlertSeverity": "2",
    "HybridVMOSDiskWriteLatencyPolicyEffect": "deployIfNotExists",
    "HybridVMDisconnectedAlertEvaluationFrequency": "PT10M",
    "HybridVMOSDiskSpacePolicyEffect": "deployIfNotExists",
    "HybridVMOSDiskReadLatencyWindowSize": "PT15M",
    "HybridVMDataDiskReadLatencyEvaluationFrequency": "PT5M",
    "HybridVMNetworkInAlertSeverity": "2",
    "HybridVMPercentCPUTimeAggregation": "Count",
    "HybridVMNetworkOutTimeAggregation": "Count",
    "BYOUserAssignedManagedIdentityResourceId": "",
    "HybridVMOSDiskReadLatencyAutoResolveTime": "00:10:00",
    "HybridVMOSDiskWriteLatencyEvaluationFrequency": "PT5M",
    "HybridVMDataDiskWriteLatencyAutoResolve": "true",
    "ALZMonitorResourceGroupLocation": "eastus",
    "HybridVMOSDiskSpaceEvaluationPeriods": "1",
    "HybridVMNetworkInFailingPeriods": "1",
    "HybridVMNetworkOutAutoResolve": "true",
    "HybridVMDataDiskSpaceAutoMitigate": "true",
    "HybridVMPercentMemoryAlertState": "true",
    "HybridVMPercentCPUAlertSeverity": "2",
    "HybridVMOSDiskWriteLatencyEvaluationPeriods": "1",
    "HybridVMOSDiskReadLatencyEvaluationPeriods": "1",
    "HybridVMNetworkOutThreshold": "10000000",
    "HybridVMDisconnectedAlertAutoMitigate": "false",
    "HybridVMDataDiskWriteLatencyAlertSeverity": "2",
    "HybridVMDataDiskSpaceAlertSeverity": "2",
    "HybridVMDataDiskWriteLatencyAlertState": "true",
    "HybridVMPercentMemoryThreshold": "10",
    "HybridVMDisconnectedAlertOperator": "GreaterThan",
    "ALZManagementSubscriptionId": "8da8d616-a90e-446a-9098-ad7381ce56a7",
    "HybridVMDataDiskSpaceTimeAggregation": "Count",
    "ALZMonitorResourceGroupTags": {
      "Project": "amba-monitoring"
    },
    "HybridVMNetworkOutEvaluationFrequency": "PT5M",
    "HybridVMDisconnectedAlertState": "true",
    "HybridVMPercentMemoryPolicyEffect": "deployIfNotExists",
    "HybridVMOSDiskReadLatencyFailingPeriods": "1",
    "HybridVMOSDiskReadLatencyAlertSeverity": "2",
    "HybridVMDataDiskWriteLatencyOperator": "GreaterThan",
    "ALZMonitorDisableTagValues": [
      "true",
      "Test",
      "Dev",
      "Sandbox"
    ],
    "HybridVMDataDiskWriteLatencyAutoResolveTime": "00:10:00",
    "HybridVMPercentCPUWindowSize": "PT15M",
    "ALZUserAssignedManagedIdentityName": "id-amba-prod-001",
    "HybridVMOSDiskWriteLatencyThreshold": "30",
    "HybridVMPercentCPUAlertState": "true",
    "HybridVMHeartBeatRGFailingPeriods": "1",
    "HybridVMOSDiskSpaceAlertState": "true",
    "HybridVMDisconnectedAlertFailingPeriods": "1",
    "HybridVMDataDiskSpacePolicyEffect": "deployIfNotExists",
    "HybridVMHeartBeatRGThreshold": "10",
    "HybridVMDataDiskReadLatencyOperator": "GreaterThan",
    "HybridVMHeartBeatRGEvaluationFrequency": "PT5M",
    "HybridVMPercentCPUAutoResolve": "true",
    "HybridVMNetworkInOperator": "GreaterThan",
    "HybridVMDataDiskSpaceAutoResolve": "true",
    "HybridVMOSDiskSpaceFailingPeriods": "1",
    "HybridVMDataDiskSpaceWindowSize": "PT15M",
    "HybridVMOSDiskReadLatencyOperator": "GreaterThan",
    "HybridVMOSDiskReadLatencyAutoResolve": "true",
    "ALZMonitorDisableTagName": "MonitorDisable",
    "HybridVMNetworkInEvaluationPeriods": "1",
    "HybridVMNetworkInPolicyEffect": "deployIfNotExists",
    "HybridVMPercentCPUOperator": "GreaterThan",
    "HybridVMNetworkOutFailingPeriods": "1",
    "HybridVMDataDiskReadLatencyThreshold": "30",
    "HybridVMOSDiskSpaceComputersToInclude": [
      "*"
    ],
    "HybridVMOSDiskWriteLatencyAutoResolveTime": "00:10:00",
    "HybridVMOSDiskWriteLatencyComputersToInclude": [
      "*"
    ],
    "HybridVMOSDiskWriteLatencyOperator": "GreaterThan",
    "HybridVMOSDiskSpaceWindowSize": "PT15M",
    "HybridVMDataDiskReadLatencyFailingPeriods": "1",
    "HybridVMDataDiskWriteLatencyFailingPeriods": "1",
    "HybridVMOSDiskSpaceThreshold": "10",
    "HybridVMOSDiskWriteLatencyFailingPeriods": "1",
    "HybridVMNetworkInTimeAggregation": "Count",
    "HybridVMDataDiskReadLatencyWindowSize": "PT15M",
    "HybridVMOSDiskReadLatencyAutoMitigate": "true",
    "HybridVMHeartBeatRGAutoMitigate": "true",
    "HybridVMNetworkOutEvaluationPeriods": "1",
    "HybridVMNetworkInAutoMitigate": "true",
    "HybridVMHeartBeatRGWindowSize": "PT6H",
    "HybridVMOSDiskSpaceEvaluationFrequency": "PT5M",
    "HybridVMDisconnectedAlertTimeAggregation": "Count",
    "HybridVMDisconnectedAlertPolicyEffect": "deployIfNotExists",
    "HybridVMOSDiskReadLatencyPolicyEffect": "deployIfNotExists",
    "HybridVMDataDiskWriteLatencyTimeAggregation": "Count",
    "HybridVMOSDiskSpaceTimeAggregation": "Count",
    "HybridVMPercentCPUAutoResolveTime": "00:10:00",
    "HybridVMDataDiskReadLatencyAlertState": "true",
    "HybridVMDataDiskSpaceEvaluationFrequency": "PT5M",
    "HybridVMOSDiskSpaceAutoMitigate": "true",
    "HybridVMOSDiskReadLatencyTimeAggregation": "Count",
    "HybridVMNetworkOutAutoResolveTime": "00:10:00",
    "HybridVMNetworkOutPolicyEffect": "deployIfNotExists",
    "HybridVMNetworkOutAutoMitigate": "true",
    "HybridVMOSDiskSpaceOperator": "GreaterThan",
    "HybridVMDataDiskWriteLatencyEvaluationFrequency": "PT5M",
    "HybridVMPercentCPUThreshold": "85",
    "HybridVMHeartBeatRGAlertSeverity": "1",
    "HybridVMDisconnectedAlertSeverity": "1",
    "HybridVMPercentMemoryAutoMitigate": "true",
    "HybridVMDataDiskReadLatencyEvaluationPeriods": "1",
    "HybridVMPercentCPUPolicyEffect": "deployIfNotExists",
    "HybridVMOSDiskSpaceAutoResolve": "true",
    "HybridVMNetworkOutWindowSize": "PT15M",
    "HybridVMOSDiskReadLatencyEvaluationFrequency": "PT5M",
    "HybridVMDataDiskReadLatencyAutoMitigate": "true",
    "HybridVMDataDiskReadLatencyPolicyEffect": "deployIfNotExists",
    "HybridVMDataDiskSpaceAlertState": "true",
    "HybridVMOSDiskSpaceAlertSeverity": "2",
    "HybridVMPercentMemoryFailingPeriods": "1",
    "HybridVMOSDiskWriteLatencyWindowSize": "PT15M",
    "HybridVMDataDiskWriteLatencyAutoMitigate": "true",
    "HybridVMNetworkOutComputersToInclude": [
      "*"
    ],
    "HybridVMDisconnectedAlertThreshold": "10m",
    "HybridVMDataDiskWriteLatencyWindowSize": "PT15M",
    "HybridVMNetworkInComputersToInclude": [
      "*"
    ],
    "HybridVMOSDiskReadLatencyComputersToInclude": [
      "*"
    ],
    "HybridVMPercentCPUAutoMitigate": "true",
    "HybridVMDataDiskWriteLatencyComputersToInclude": [
      "*"
    ],
    "HybridVMNetworkInAutoResolve": "true",
    "HybridVMPercentCPUFailingPeriods": "1",
    "HybridVMOSDiskReadLatencyThreshold": "30",
    "HybridVMDataDiskWriteLatencyThreshold": "30",
    "HybridVMOSDiskReadLatencyAlertState": "true",
    "HybridVMNetworkOutAlertSeverity": "2",
    "HybridVMNetworkInThreshold": "10000000",
    "HybridVMDataDiskSpaceFailingPeriods": "1"
  },
  "scope": {
    "amba": [
      "/providers/Microsoft.Management/managementGroups/amba-platform",
      "/providers/Microsoft.Management/managementGroups/amba-landingzones"
    ]
  }
}